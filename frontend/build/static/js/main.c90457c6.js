/*! For license information please see main.c90457c6.js.LICENSE.txt */
(()=>{"use strict";var e={345:(e,t,n)=>{var r=n(950),a=n(340);function s(e){for(var t="https://98757830-656a-4e37-a9a5-09197b7bc2fa.preview.emergentagent.com","/api"),$t=(0,a.createContext)(),Kt=e=>{let{children:t}=e;const[n,r]=(0,a.useState)(null),[s,l]=(0,a.useState)(!0);(0,a.useEffect)((()=>{i()}),[]);const i=async()=>{const e=localStorage.getItem("token");if(e)try{const t=await Rt.get("".concat(Wt,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});r(t.data)}catch(t){localStorage.removeItem("token")}l(!1)};return(0,Vt.jsx)($t.Provider,{value:{user:n,login:async(e,t)=>{try{const n=await Rt.post("".concat(Wt,"/auth/login"),{email:e,password:t}),{access_token:a,user:s}=n.data;return localStorage.setItem("token",a),r(s),{success:!0,user:s}}catch(s){var n,a;return{success:!1,error:(null===(n=s.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.detail)||"Login failed"}}},register:async(e,t,n)=>{try{return await Rt.post("".concat(Wt,"/auth/register"),{name:e,email:t,password:n}),{success:!0}}catch(s){var r,a;return{success:!1,error:(null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.detail)||"Registration failed"}}},logout:()=>{localStorage.removeItem("token"),r(null)},loading:s},children:t})},Yt=()=>(0,a.useContext)($t),Xt=e=>"string"!==typeof e?e:e.includes("$")||e.includes("\\(")||e.includes("\\[")?(0,Vt.jsx)("span",{dangerouslySetInnerHTML:{__html:e},className:"tex2jax_process"}):e;function Gt(e){let{imageSrc:t,onCropComplete:n,onClose:r}=e;const[s,l]=(0,a.useState)({unit:"%",width:90,height:90,x:5,y:5}),[i,o]=(0,a.useState)(null),c=(0,a.useRef)(null),u=(0,a.useRef)(null);return(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-screen overflow-auto",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Vt.jsx)("h3",{className:"text-lg font-semibold",children:"Crop Image"}),(0,Vt.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,Vt.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,Vt.jsx)("div",{className:"flex-1",children:(0,Vt.jsx)(Ht,{crop:s,onChange:e=>l(e),onComplete:e=>o(e),aspect:void 0,className:"max-w-full",children:(0,Vt.jsx)("img",{ref:c,src:t,alt:"Crop preview",className:"max-w-full h-auto",style:{maxHeight:"400px"}})})}),(0,Vt.jsxs)("div",{className:"lg:w-64",children:[(0,Vt.jsx)("h4",{className:"font-semibold mb-2",children:"Preview:"}),(0,Vt.jsx)("canvas",{ref:u,className:"border rounded max-w-full",style:{maxWidth:"200px",maxHeight:"200px"}}),(0,Vt.jsx)("div",{className:"mt-4 space-y-2",children:(0,Vt.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,Vt.jsxs)("p",{children:["Width: ",Math.round(s.width),"%"]}),(0,Vt.jsxs)("p",{children:["Height: ",Math.round(s.height),"%"]})]})})]})]}),(0,Vt.jsxs)("div",{className:"flex gap-4 pt-4 mt-4 border-t",children:[(0,Vt.jsx)("button",{onClick:()=>{if(i&&c.current&&u.current){const e=c.current,t=u.current,r=i,a=e.naturalWidth/e.width,s=e.naturalHeight/e.height,l=t.getContext("2d"),o=window.devicePixelRatio;t.width=r.width*o*a,t.height=r.height*o*s,l.setTransform(o,0,0,o,0,0),l.imageSmoothingQuality="high",l.drawImage(e,r.x*a,r.y*s,r.width*a,r.height*s,0,0,r.width*a,r.height*s),t.toBlob((e=>{if(e){const t=new FileReader;t.onload=()=>{n(t.result)},t.readAsDataURL(e)}}),"image/jpeg",.95)}},className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-200",children:"\u2702\ufe0f Apply Crop"}),(0,Vt.jsx)("button",{onClick:r,className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition duration-200",children:"Cancel"})]})]})})}const Jt=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=localStorage.getItem("token"),r=u(u({"Content-Type":"application/json"},n&&{Authorization:"Bearer ".concat(n)}),t.headers);return Rt(u({url:"".concat(Wt).concat(e),headers:r},t))};function Zt(){const{user:e,loading:t}=Yt(),[n,r]=(0,a.useState)("home");return(0,a.useEffect)((()=>{(async()=>{try{if(window.MathJax&&window.MathJax.typesetPromise)return void console.log("\u2705 MathJax already loaded from window object");setTimeout((()=>{if(window.mathJaxLoading)return;window.mathJaxLoading=!0,window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"},startup:{ready(){window.MathJax.startup.defaultReady(),console.log("\u2705 MathJax initialized successfully"),window.mathJaxLoading=!1}}};const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js",e.async=!0,e.onload=()=>console.log("\u2705 MathJax loaded from CDN"),e.onerror=()=>{console.warn("\u26a0\ufe0f MathJax CDN loading failed"),window.mathJaxLoading=!1},document.head.appendChild(e)}),100)}catch(e){console.warn("\u26a0\ufe0f MathJax initialization failed:",e)}})()}),[]),t?(0,Vt.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,Vt.jsxs)("div",{className:"text-center",children:[(0,Vt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,Vt.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):e?"admin"===e.role?(0,Vt.jsx)(tn,{currentView:n,setCurrentView:r}):(0,Vt.jsx)(un,{currentView:n,setCurrentView:r}):(0,Vt.jsx)(en,{})}function en(){const{login:e,register:t}=Yt(),[n,r]=(0,a.useState)(!0),[s,l]=(0,a.useState)({name:"",email:"",password:""}),[i,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1);return(0,Vt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 flex items-center justify-center p-4",children:(0,Vt.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:[(0,Vt.jsxs)("div",{className:"text-center mb-8",children:[(0,Vt.jsx)("h1",{className:"text-3xl font-bold text-indigo-900 mb-2",children:"\ud83d\udcdd Squiz"}),(0,Vt.jsx)("p",{className:"text-gray-600",children:"Admin-Controlled Quiz Platform"})]}),(0,Vt.jsxs)("form",{onSubmit:async a=>{let l;a.preventDefault(),d(!0),o(""),n?l=await e(s.email,s.password):(l=await t(s.name,s.email,s.password),l.success&&(r(!0),o("Registration successful! Please log in."))),l.success||o(l.error),d(!1)},className:"space-y-4",children:[!n&&(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Full Name"}),(0,Vt.jsx)("input",{type:"text",value:s.name,onChange:e=>l(u(u({},s),{},{name:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter your full name",required:!0})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Email"}),(0,Vt.jsx)("input",{type:"email",value:s.email,onChange:e=>l(u(u({},s),{},{email:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter your email",required:!0})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Password"}),(0,Vt.jsx)("input",{type:"password",value:s.password,onChange:e=>l(u(u({},s),{},{password:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter your password",required:!0})]}),i&&(0,Vt.jsx)("div",{className:"p-3 rounded-lg ".concat(i.includes("successful")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:i}),(0,Vt.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition duration-200 font-semibold disabled:opacity-50",children:c?"Processing...":n?"Login":"Register"})]}),(0,Vt.jsx)("div",{className:"mt-6 text-center",children:(0,Vt.jsx)("button",{onClick:()=>{r(!n),o(""),l({name:"",email:"",password:""})},className:"text-indigo-600 hover:text-indigo-800 font-semibold",children:n?"Yeni hesab yarat":"Giriş hissəyə qayıt"})})]})})}function tn(e){let{currentView:t,setCurrentView:n}=e;const{user:r,logout:s}=Yt(),[l,i]=(0,a.useState)([]),[o,c]=(0,a.useState)([]),[u,d]=(0,a.useState)([]),[f,h]=(0,a.useState)([]),[m,p]=(0,a.useState)({});(0,a.useEffect)((()=>{"users"===t&&g(),"quizzes"===t&&x(),"categories"===t&&b(),"results"===t&&y(),"dashboard"===t&&v()}),[t]);const g=async()=>{try{const e=await Jt("/admin/users");i(e.data)}catch(e){console.error("Error fetching users:",e)}},x=async()=>{try{const e=await Jt("/admin/quizzes");c(e.data)}catch(e){console.error("Error fetching quizzes:",e)}},b=async()=>{try{const e=await Jt("/admin/categories");d(e.data)}catch(e){console.error("Error fetching categories:",e)}},y=async()=>{try{const e=await Jt("/admin/quiz-results");h(e.data)}catch(e){console.error("Error fetching quiz results:",e)}},v=async()=>{try{const e=await Jt("/admin/analytics/summary");p(e.data)}catch(e){console.error("Error fetching analytics:",e)}};return(0,Vt.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,Vt.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,Vt.jsxs)("div",{className:"container mx-auto px-4 py-4 flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[(0,Vt.jsxs)("div",{className:"mb-4 sm:mb-0",children:[(0,Vt.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"\ud83d\udc51 Admin Dashboard"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm sm:text-base",children:["Welcome back, ",r.name]})]}),(0,Vt.jsx)("button",{onClick:s,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition duration-200 text-sm sm:text-base",children:"Logout"})]})}),(0,Vt.jsxs)("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[(0,Vt.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-4 mb-6 sm:mb-8 overflow-x-auto pb-2",children:[(0,Vt.jsx)("button",{onClick:()=>n("dashboard"),className:"px-3 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition duration-200 text-xs sm:text-sm whitespace-nowrap ".concat("dashboard"===t?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"\ud83d\udcca Dashboard"}),(0,Vt.jsx)("button",{onClick:()=>n("users"),className:"px-3 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition duration-200 text-xs sm:text-sm whitespace-nowrap ".concat("users"===t?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"\ud83d\udc65 Users"}),(0,Vt.jsx)("button",{onClick:()=>n("quizzes"),className:"px-3 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition duration-200 text-xs sm:text-sm whitespace-nowrap ".concat("quizzes"===t?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"\ud83d\udcdd Quizzes"}),(0,Vt.jsx)("button",{onClick:()=>n("results"),className:"px-3 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition duration-200 text-xs sm:text-sm whitespace-nowrap ".concat("results"===t?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"\ud83d\udcc8 Results"}),(0,Vt.jsx)("button",{onClick:()=>n("categories"),className:"px-3 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition duration-200 text-xs sm:text-sm whitespace-nowrap ".concat("categories"===t?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"\ud83d\uddc2\ufe0f Categories"}),(0,Vt.jsx)("button",{onClick:()=>n("create-quiz"),className:"px-3 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition duration-200 text-xs sm:text-sm whitespace-nowrap ".concat("create-quiz"===t?"bg-green-600 text-white":"bg-green-600 text-white hover:bg-green-700"),children:"\u2795 Create Quiz"})]}),"dashboard"===t&&(0,Vt.jsx)(nn,{analytics:m}),"users"===t&&(0,Vt.jsx)(an,{users:l}),"quizzes"===t&&(0,Vt.jsx)(sn,{quizzes:o,fetchQuizzes:x}),"results"===t&&(0,Vt.jsx)(rn,{results:f}),"categories"===t&&(0,Vt.jsx)(on,{categories:u,fetchCategories:b}),"create-quiz"===t&&(0,Vt.jsx)(cn,{setCurrentView:n})]})]})}function nn(e){let{analytics:t}=e;return(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,Vt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,Vt.jsxs)("div",{className:"flex items-center",children:[(0,Vt.jsx)("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600",children:"\ud83d\udc65"}),(0,Vt.jsxs)("div",{className:"ml-4",children:[(0,Vt.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),(0,Vt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:t.total_users||0})]})]})}),(0,Vt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,Vt.jsxs)("div",{className:"flex items-center",children:[(0,Vt.jsx)("div",{className:"p-3 rounded-full bg-green-100 text-green-600",children:"\ud83d\udcdd"}),(0,Vt.jsxs)("div",{className:"ml-4",children:[(0,Vt.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Total Quizzes"}),(0,Vt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:t.total_quizzes||0})]})]})}),(0,Vt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,Vt.jsxs)("div",{className:"flex items-center",children:[(0,Vt.jsx)("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600",children:"\ud83d\udcca"}),(0,Vt.jsxs)("div",{className:"ml-4",children:[(0,Vt.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Total Attempts"}),(0,Vt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:t.total_attempts||0})]})]})}),(0,Vt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,Vt.jsxs)("div",{className:"flex items-center",children:[(0,Vt.jsx)("div",{className:"p-3 rounded-full bg-yellow-100 text-yellow-600",children:"\ud83c\udfaf"}),(0,Vt.jsxs)("div",{className:"ml-4",children:[(0,Vt.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Average Score"}),(0,Vt.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[t.average_score||0,"%"]})]})]})})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Vt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,Vt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\udcc8 Platform Overview"}),(0,Vt.jsxs)("div",{className:"space-y-3",children:[(0,Vt.jsxs)("div",{className:"flex justify-between",children:[(0,Vt.jsx)("span",{className:"text-gray-600",children:"Most Popular Quiz:"}),(0,Vt.jsx)("span",{className:"font-medium",children:t.most_popular_quiz||"None"})]}),(0,Vt.jsxs)("div",{className:"flex justify-between",children:[(0,Vt.jsx)("span",{className:"text-gray-600",children:"Platform Status:"}),(0,Vt.jsx)("span",{className:"text-green-600 font-medium",children:"Active"})]})]})]}),(0,Vt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,Vt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\ude80 Quick Actions"}),(0,Vt.jsxs)("div",{className:"space-y-2",children:[(0,Vt.jsx)("p",{className:"text-gray-600",children:"\u2022 Create new quizzes and manage content"}),(0,Vt.jsx)("p",{className:"text-gray-600",children:"\u2022 View detailed user test results"}),(0,Vt.jsx)("p",{className:"text-gray-600",children:"\u2022 Manage user accounts and permissions"}),(0,Vt.jsx)("p",{className:"text-gray-600",children:"\u2022 Organize quizzes by categories"})]})]})]})]})}function rn(e){let{results:t}=e;const[n,r]=(0,a.useState)("all"),[s,l]=(0,a.useState)("date_desc"),i=t.filter((e=>"all"===n||("high_score"===n?e.percentage>=80:"low_score"!==n||e.percentage<60))).sort(((e,t)=>{switch(s){case"date_desc":return new Date(t.attempted_at)-new Date(e.attempted_at);case"date_asc":return new Date(e.attempted_at)-new Date(t.attempted_at);case"score_desc":return t.percentage-e.percentage;case"score_asc":return e.percentage-t.percentage;case"user_name":return e.user.name.localeCompare(t.user.name);default:return 0}})),o=e=>e>=80?"text-green-600 bg-green-100":e>=60?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100";return(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"\ud83d\udcc8 User Test Results"}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsxs)("select",{value:n,onChange:e=>r(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[(0,Vt.jsx)("option",{value:"all",children:"All Results"}),(0,Vt.jsx)("option",{value:"high_score",children:"High Scores (80%+)"}),(0,Vt.jsx)("option",{value:"low_score",children:"Low Scores (<60%)"})]}),(0,Vt.jsxs)("select",{value:s,onChange:e=>l(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",children:[(0,Vt.jsx)("option",{value:"date_desc",children:"Newest First"}),(0,Vt.jsx)("option",{value:"date_asc",children:"Oldest First"}),(0,Vt.jsx)("option",{value:"score_desc",children:"Highest Score"}),(0,Vt.jsx)("option",{value:"score_asc",children:"Lowest Score"}),(0,Vt.jsx)("option",{value:"user_name",children:"User Name"})]})]})]}),0===i.length?(0,Vt.jsx)("div",{className:"text-center py-12",children:(0,Vt.jsx)("p",{className:"text-gray-500 text-lg",children:"No test results found."})}):(0,Vt.jsx)("div",{className:"overflow-x-auto",children:(0,Vt.jsxs)("table",{className:"w-full",children:[(0,Vt.jsx)("thead",{children:(0,Vt.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,Vt.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"User"}),(0,Vt.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Quiz"}),(0,Vt.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Category"}),(0,Vt.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Score"}),(0,Vt.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Percentage"}),(0,Vt.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Performance"}),(0,Vt.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Date"})]})}),(0,Vt.jsx)("tbody",{children:i.map(((e,t)=>{return(0,Vt.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,Vt.jsx)("td",{className:"py-3 px-4",children:(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"font-semibold text-gray-800",children:e.user.name}),(0,Vt.jsx)("p",{className:"text-sm text-gray-500",children:e.user.email})]})}),(0,Vt.jsx)("td",{className:"py-3 px-4",children:(0,Vt.jsx)("p",{className:"font-medium text-gray-800",children:e.quiz.title})}),(0,Vt.jsx)("td",{className:"py-3 px-4",children:(0,Vt.jsx)("span",{className:"inline-block px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded",children:e.quiz.category})}),(0,Vt.jsx)("td",{className:"py-3 px-4",children:(0,Vt.jsxs)("p",{className:"font-semibold",children:[e.score,"/",e.total_questions]})}),(0,Vt.jsx)("td",{className:"py-3 px-4",children:(0,Vt.jsxs)("span",{className:"inline-block px-2 py-1 rounded text-sm font-semibold ".concat(o(e.percentage)),children:[e.percentage.toFixed(1),"%"]})}),(0,Vt.jsx)("td",{className:"py-3 px-4",children:(0,Vt.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium ".concat(o(e.percentage)),children:(n=e.percentage,n>=80?"Excellent":n>=60?"Good":"Needs Improvement")})}),(0,Vt.jsxs)("td",{className:"py-3 px-4",children:[(0,Vt.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.attempted_at).toLocaleDateString()}),(0,Vt.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.attempted_at).toLocaleTimeString()})]})]},t);var n}))})]})}),(0,Vt.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,Vt.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"\ud83d\udcca Summary Statistics"}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"text-gray-600",children:"Total Results:"}),(0,Vt.jsx)("p",{className:"font-semibold",children:i.length})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"text-gray-600",children:"High Scores (80%+):"}),(0,Vt.jsx)("p",{className:"font-semibold text-green-600",children:i.filter((e=>e.percentage>=80)).length})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"text-gray-600",children:"Average Score:"}),(0,Vt.jsxs)("p",{className:"font-semibold",children:[i.length>0?(i.reduce(((e,t)=>e+t.percentage),0)/i.length).toFixed(1):0,"%"]})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"text-gray-600",children:"Low Scores (<60%):"}),(0,Vt.jsx)("p",{className:"font-semibold text-red-600",children:i.filter((e=>e.percentage<60)).length})]})]})]})]})}function an(e){let{users:t}=e;return(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Vt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Registered Users"}),(0,Vt.jsx)("div",{className:"overflow-x-auto",children:(0,Vt.jsxs)("table",{className:"w-full",children:[(0,Vt.jsx)("thead",{children:(0,Vt.jsxs)("tr",{className:"border-b",children:[(0,Vt.jsx)("th",{className:"text-left py-2",children:"Name"}),(0,Vt.jsx)("th",{className:"text-left py-2",children:"Email"}),(0,Vt.jsx)("th",{className:"text-left py-2",children:"Role"}),(0,Vt.jsx)("th",{className:"text-left py-2",children:"Status"}),(0,Vt.jsx)("th",{className:"text-left py-2",children:"Joined"})]})}),(0,Vt.jsx)("tbody",{children:t.map((e=>(0,Vt.jsxs)("tr",{className:"border-b",children:[(0,Vt.jsx)("td",{className:"py-2",children:e.name}),(0,Vt.jsx)("td",{className:"py-2",children:e.email}),(0,Vt.jsx)("td",{className:"py-2",children:(0,Vt.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("admin"===e.role?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.role})}),(0,Vt.jsx)("td",{className:"py-2",children:(0,Vt.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.is_active?"Active":"Inactive"})}),(0,Vt.jsx)("td",{className:"py-2",children:new Date(e.created_at).toLocaleDateString()})]},e.id)))})]})})]})}function sn(e){let{quizzes:t,fetchQuizzes:n}=e;const[r,s]=(0,a.useState)(null),[l,i]=(0,a.useState)(!1),[o,c]=(0,a.useState)({}),[d,f]=(0,a.useState)("list"),[h,m]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)({subject:"",subcategory:"General"}),[y,v]=(0,a.useState)({}),[w,j]=(0,a.useState)(new Set),[N,k]=(0,a.useState)(!1),[S,_]=(0,a.useState)(!1);(0,a.useEffect)((()=>{"folders"===d&&C(),E()}),[d]);const C=async()=>{try{const e=await Jt("/admin/subjects-structure");c(e.data)}catch(e){console.error("Error fetching subjects structure:",e)}},E=async()=>{try{const e=await Jt("/admin/predefined-subjects");v(e.data)}catch(e){console.error("Error fetching subjects:",e)}},[z,P]=(0,a.useState)({show:!1,quizId:null,quizTitle:""}),O=e=>{let{quiz:t,showSubject:r=!0}=e;const a=w.has(t.id),l=t.is_draft;return(0,Vt.jsxs)("div",{className:"border rounded-lg p-4 relative",children:[l&&(0,Vt.jsx)("div",{className:"absolute top-2 right-2 z-10",children:(0,Vt.jsx)("input",{type:"checkbox",checked:a,onChange:e=>{const n=new Set(w);e.target.checked?n.add(t.id):n.delete(t.id),j(n)},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),(0,Vt.jsxs)("div",{className:"mb-2 flex flex-wrap gap-1",children:[(0,Vt.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs ".concat(t.is_public?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:t.is_public?"Public":"Private"}),(0,Vt.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs ".concat(t.is_draft?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:t.is_draft?"\ud83d\udcdd Draft":"\u2705 Published"}),r&&(0,Vt.jsxs)(Vt.Fragment,{children:[(0,Vt.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:t.subject||"General"}),(0,Vt.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs bg-purple-100 text-purple-800",children:t.subcategory||"General"})]})]}),t.is_draft&&(0,Vt.jsx)("div",{className:"mb-3 p-2 bg-orange-50 border-l-4 border-orange-400 rounded",children:(0,Vt.jsx)("p",{className:"text-xs text-orange-700",children:"\u26a0\ufe0f This quiz is in draft mode. Users cannot take it until published."})}),(0,Vt.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:t.title}),(0,Vt.jsx)("p",{className:"text-gray-600 text-sm mb-2 line-clamp-2",children:t.description}),(0,Vt.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-500 mb-3",children:[(0,Vt.jsx)("span",{children:t.category}),(0,Vt.jsxs)("span",{children:[t.total_questions," questions"]})]}),(0,Vt.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-500 mb-3",children:[(0,Vt.jsxs)("span",{children:[t.total_attempts||0," attempts"]}),(0,Vt.jsxs)("span",{className:"font-medium",children:["Avg: ",t.average_score||0,"%"]})]}),(0,Vt.jsxs)("div",{className:"text-xs text-gray-400 mb-3",children:["Created: ",new Date(t.created_at).toLocaleDateString(),t.updated_at!==t.created_at&&(0,Vt.jsxs)("div",{children:["Updated: ",new Date(t.updated_at).toLocaleDateString()]})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-2 gap-1 text-xs mb-2",children:[(0,Vt.jsx)("button",{onClick:()=>(async e=>{try{const t=await Jt("/admin/quiz/".concat(e.id,"/edit-details"));s(t.data.quiz),i(!0)}catch(r){var t,n;alert("Error loading quiz details: "+((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||"Unknown error"))}})(t),className:"bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition duration-200",children:"\u270f\ufe0f Edit"}),(0,Vt.jsx)("button",{onClick:()=>(async e=>{try{if(!e.is_draft)return void alert("Quiz is already published. To make changes, please create a new version.");await Jt("/admin/quiz/".concat(e.id,"/publish"),{method:"POST"}),alert("Quiz published successfully! Users can now take this quiz."),n(),"folders"===d&&C()}catch(a){var t,r;const e=(null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||a.message||"Unknown error";alert("Error publishing quiz: "+e)}})(t),className:"py-2 rounded transition duration-200 ".concat(t.is_draft?"bg-green-600 text-white hover:bg-green-700":"bg-gray-400 text-white cursor-not-allowed"),disabled:!t.is_draft,children:t.is_draft?"\ud83d\ude80 Publish":"\u2705 Published"})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-2 gap-1 text-xs mb-2",children:[(0,Vt.jsx)("button",{onClick:()=>(async e=>{try{await Jt("/admin/quiz/".concat(e.id),{method:"PUT",data:{is_public:!e.is_public}}),n(),"folders"===d&&C()}catch(t){alert("Error updating quiz visibility")}})(t),className:"py-2 rounded transition duration-200 ".concat(t.is_public?"bg-yellow-600 text-white hover:bg-yellow-700":"bg-indigo-600 text-white hover:bg-indigo-700"),children:t.is_public?"\ud83d\udd12 Private":"\ud83d\udd13 Public"}),(0,Vt.jsx)("button",{onClick:()=>(e=>{m(e),b({subject:e.subject||Object.keys(y)[0]||"",subcategory:e.subcategory||"General"}),g(!0)})(t),className:"bg-purple-600 text-white py-2 rounded hover:bg-purple-700 transition duration-200",children:"\ud83d\udcc1 Move"})]}),(0,Vt.jsx)("div",{className:"grid grid-cols-1 gap-1 text-xs",children:(0,Vt.jsx)("button",{onClick:()=>async function(e){P({show:!0,quizId:e,quizTitle:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"this quiz"})}(t.id,t.title),className:"bg-red-600 text-white py-2 rounded hover:bg-red-700 transition duration-200",children:"\ud83d\uddd1\ufe0f Delete"})})]})},R=()=>(0,Vt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e=>(0,Vt.jsx)(O,{quiz:e},e.id)))}),T=()=>(0,Vt.jsx)("div",{className:"space-y-6",children:Object.entries(o).map((e=>{let[t,n]=e;return(0,Vt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,Vt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Vt.jsxs)("h3",{className:"text-xl font-semibold text-gray-800",children:["\ud83d\udcc1 ",t]}),(0,Vt.jsxs)("span",{className:"ml-3 px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:[n.total_quizzes," quizzes"]})]}),(0,Vt.jsx)("div",{className:"space-y-4",children:Object.entries(n.subcategories).map((e=>{let[t,n]=e;return(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,Vt.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Vt.jsxs)("h4",{className:"text-lg font-medium text-gray-700",children:["\ud83d\udcc2 ",t]}),(0,Vt.jsxs)("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs",children:[n.quiz_count," quizzes"]})]}),(0,Vt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.quizzes.map((e=>(0,Vt.jsx)(O,{quiz:e,showSubject:!1},e.id)))})]},t)}))})]},t)}))});return(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Quiz Management (Sorted by Date)"}),(0,Vt.jsxs)("div",{className:"flex gap-2",children:[(0,Vt.jsx)("button",{onClick:()=>f("list"),className:"px-4 py-2 rounded-lg transition duration-200 ".concat("list"===d?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"\ud83d\udccb List View"}),(0,Vt.jsx)("button",{onClick:()=>f("folders"),className:"px-4 py-2 rounded-lg transition duration-200 ".concat("folders"===d?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"\ud83d\udcc1 Folder View"})]})]}),w.size>0&&(0,Vt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:(0,Vt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Vt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Vt.jsxs)("span",{className:"text-sm font-medium text-blue-800",children:[w.size," quiz",w.size>1?"es":""," selected"]}),(0,Vt.jsx)("button",{onClick:()=>j(new Set),className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"Clear selection"})]}),(0,Vt.jsx)("div",{className:"flex gap-2",children:(0,Vt.jsx)("button",{onClick:()=>k(!0),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition duration-200",disabled:S,children:S?"\u23f3 Publishing...":"\ud83d\ude80 Bulk Publish"})})]})}),"list"===d?(0,Vt.jsx)(R,{}):(0,Vt.jsx)(T,{}),l&&r&&(0,Vt.jsx)(ln,{quiz:r,onClose:()=>{i(!1),s(null)},onUpdate:async(e,t)=>{try{await Jt("/admin/quiz/".concat(e),{method:"PUT",data:t}),i(!1),s(null),n(),"folders"===d&&C(),alert("Quiz updated successfully!")}catch(l){var r,a;alert("Error updating quiz: "+((null===(r=l.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.detail)||"Unknown error"))}}}),z.show&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"text-center mb-6",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\uddd1\ufe0f"}),(0,Vt.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Delete Quiz?"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm",children:['Are you sure you want to delete "',z.quizTitle,'"?']}),(0,Vt.jsx)("p",{className:"text-red-600 text-sm mt-2",children:"\u26a0\ufe0f This action cannot be undone."})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsx)("button",{onClick:async()=>{const{quizId:e}=z;try{console.log("Attempting to delete quiz with ID:",e);const t=await Jt("/admin/quiz/".concat(e),{method:"DELETE"});console.log("Delete response:",t),alert("Quiz deleted successfully!"),n(),"folders"===d&&C(),P({show:!1,quizId:null,quizTitle:""})}catch(a){var t,r;console.error("Error deleting quiz:",a);const e=(null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||a.message||"Unknown error occurred";alert("Error deleting quiz: ".concat(e)),P({show:!1,quizId:null,quizTitle:""})}},className:"flex-1 bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 transition duration-200 font-semibold",children:"Yes, Delete"}),(0,Vt.jsx)("button",{onClick:()=>P({show:!1,quizId:null,quizTitle:""}),className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]})}),p&&h&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vt.jsx)("h3",{className:"text-lg font-semibold",children:"Move Quiz to Different Folder"}),(0,Vt.jsx)("button",{onClick:()=>{g(!1),m(null)},className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,Vt.jsxs)("div",{className:"mb-4",children:[(0,Vt.jsxs)("p",{className:"text-sm text-gray-600 mb-3",children:["Moving quiz: ",(0,Vt.jsxs)("strong",{children:['"',h.title,'"']})]}),(0,Vt.jsxs)("p",{className:"text-xs text-gray-500 mb-4",children:["Current location: ",h.subject||"General"," \u2192 ",h.subcategory||"General"]})]}),(0,Vt.jsxs)("div",{className:"space-y-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Destination Subject *"}),(0,Vt.jsx)("select",{value:x.subject,onChange:e=>b(u(u({},x),{},{subject:e.target.value,subcategory:"General"})),className:"w-full p-3 border border-gray-300 rounded-lg",children:Object.keys(y).map((e=>(0,Vt.jsx)("option",{value:e,children:e},e)))})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Destination Subcategory"}),(0,Vt.jsx)("select",{value:x.subcategory,onChange:e=>b(u(u({},x),{},{subcategory:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",children:(y[x.subject]||["General"]).map((e=>(0,Vt.jsx)("option",{value:e,children:e},e)))})]})]}),(0,Vt.jsxs)("div",{className:"flex gap-4 pt-6",children:[(0,Vt.jsx)("button",{onClick:async()=>{if(h&&x.subject)try{await Jt("/admin/quiz/".concat(h.id,"/move-folder"),{method:"POST",data:{new_subject:x.subject,new_subcategory:x.subcategory}}),g(!1),m(null),n(),"folders"===d&&C(),alert("Quiz moved successfully!")}catch(r){var e,t;alert("Error moving quiz: "+((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Unknown error"))}else alert("Please select a destination folder")},className:"flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition duration-200 font-semibold",children:"\ud83d\udcc1 Move Quiz"}),(0,Vt.jsx)("button",{onClick:()=>{g(!1),m(null)},className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]})}),N&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"text-center mb-6",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\ude80"}),(0,Vt.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Bulk Publish Quizzes"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm",children:["Are you sure you want to publish ",w.size," selected quiz",w.size>1?"es":"","?"]}),(0,Vt.jsx)("p",{className:"text-blue-600 text-sm mt-2",children:"\u2705 Published quizzes will be available for users to take immediately."})]}),(0,Vt.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[(0,Vt.jsx)("p",{className:"text-sm text-gray-700 font-medium mb-2",children:"Selected Quizzes:"}),(0,Vt.jsx)("div",{className:"max-h-32 overflow-y-auto",children:t.filter((e=>w.has(e.id)&&e.is_draft)).map((e=>(0,Vt.jsxs)("div",{className:"text-xs text-gray-600 py-1 border-b border-gray-200",children:["\ud83d\udcdd ",e.title]},e.id)))})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsx)("button",{onClick:async()=>{_(!0);let e=0,t=0;const r=[];try{for(const n of w)try{await Jt("/admin/quiz/".concat(n,"/publish"),{method:"POST"}),e++}catch(l){var a,s;t++,r.push("Quiz ".concat(n,": ").concat((null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.detail)||"Unknown error"))}e>0&&alert("\u2705 Successfully published ".concat(e," quiz").concat(e>1?"es":"","!")),t>0&&alert("\u26a0\ufe0f Failed to publish ".concat(t," quiz").concat(t>1?"es":"",":\n").concat(r.join("\n"))),await n(),j(new Set),k(!1)}catch(l){alert("Error during bulk publish: "+(l.message||"Unknown error"))}finally{_(!1)}},disabled:S,className:"flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition duration-200 font-semibold disabled:opacity-50",children:S?"\u23f3 Publishing...":"\ud83d\ude80 Publish All"}),(0,Vt.jsx)("button",{onClick:()=>k(!1),disabled:S,className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold disabled:opacity-50",children:"Cancel"})]})]})})]})}function ln(e){let{quiz:t,onClose:n,onUpdate:r}=e;const[s,l]=(0,a.useState)({title:t.title,description:t.description,category:t.category,subject:t.subject||"",subcategory:t.subcategory||"General",is_public:t.is_public,is_active:t.is_active,allowed_users:t.allowed_users||[],questions:[...t.questions]}),[i,o]=(0,a.useState)({}),[c,d]=(0,a.useState)([]),[f,h]=(0,a.useState)(null),[m,p]=(0,a.useState)(!1);(0,a.useEffect)((()=>{g(),s.is_public&&x()}),[s.is_public]);const g=async()=>{try{const e=await Jt("/admin/predefined-subjects");o(e.data)}catch(e){console.error("Error fetching subjects:",e)}},x=async()=>{try{const e=await Jt("/admin/users");d(e.data.filter((e=>"user"===e.role)))}catch(e){console.error("Error fetching users:",e)}},b=async(e,t)=>{const n=e.target.files[0];if(!n)return;if(!n.type.startsWith("image/"))return void alert("Please select an image file");if(n.size>5242880)return void alert("File size must be less than 5MB");const r=await(async e=>{const t=new FormData;t.append("file",e);try{return p(!0),(await Jt("/admin/upload-image",{method:"POST",data:t,headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).data.url}catch(a){var n,r;return alert("Error uploading image: "+((null===(n=a.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.detail)||"Unknown error")),null}finally{p(!1)}})(n);if(r){const e=[...s.questions];e[t].image_url=r,l(u(u({},s),{},{questions:e}))}},y=(e,t,n,r)=>{const a=[...s.questions];"is_correct"===n&&r&&a[e].options.forEach((e=>e.is_correct=!1)),a[e].options[t][n]=r,l(u(u({},s),{},{questions:a}))},[v,w]=(0,a.useState)({show:!1,questionIndex:null});return(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl mx-4 my-8 max-h-screen overflow-y-auto",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vt.jsxs)("h3",{className:"text-2xl font-semibold",children:["Edit Quiz: ",t.title]}),(0,Vt.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\u2715"})]}),(0,Vt.jsxs)("form",{onSubmit:e=>{e.preventDefault();for(let t=0;t<s.questions.length;t++){const e=s.questions[t];if(!e.question_text||!e.options.every((e=>e.text))||!e.options.some((e=>e.is_correct)))return void alert("Question ".concat(t+1," is incomplete. Please fill all fields and select correct answer."))}0!==s.questions.length?r(t.id,s):alert("Please add at least one question")},className:"space-y-6",children:[(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Title"}),(0,Vt.jsx)("input",{type:"text",value:s.title,onChange:e=>l(u(u({},s),{},{title:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Category"}),(0,Vt.jsx)("input",{type:"text",value:s.category,onChange:e=>l(u(u({},s),{},{category:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0})]})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Description"}),(0,Vt.jsx)("textarea",{value:s.description,onChange:e=>l(u(u({},s),{},{description:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",rows:"3",required:!0})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Subject"}),(0,Vt.jsx)("select",{value:s.subject,onChange:e=>l(u(u({},s),{},{subject:e.target.value,subcategory:"General"})),className:"w-full p-3 border border-gray-300 rounded-lg",children:Object.keys(i).map((e=>(0,Vt.jsx)("option",{value:e,children:e},e)))})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Subcategory"}),(0,Vt.jsx)("select",{value:s.subcategory,onChange:e=>l(u(u({},s),{},{subcategory:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",children:(i[s.subject]||["General"]).map((e=>(0,Vt.jsx)("option",{value:e,children:e},e)))})]})]}),(0,Vt.jsxs)("div",{className:"flex flex-wrap items-center space-x-6",children:[(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:s.is_public,onChange:e=>l(u(u({},s),{},{is_public:e.target.checked,allowed_users:[]})),className:"mr-2"}),"Public Quiz"]}),(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:s.is_active,onChange:e=>l(u(u({},s),{},{is_active:e.target.checked})),className:"mr-2"}),"Active"]})]}),s.is_public&&(0,Vt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Vt.jsxs)("label",{className:"block text-gray-700 font-semibold mb-2",children:["Select Users Who Can Access This Quiz (",s.allowed_users.length," selected)"]}),(0,Vt.jsx)("div",{className:"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-3",children:c.map((e=>(0,Vt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:s.allowed_users.includes(e.id),onChange:()=>{return t=e.id,void l(u(u({},s),{},{allowed_users:s.allowed_users.includes(t)?s.allowed_users.filter((e=>e!==t)):[...s.allowed_users,t]}));var t},className:"mr-3"}),(0,Vt.jsxs)("span",{className:"text-sm",children:[e.name," (",e.email,")"]})]},e.id)))})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Vt.jsxs)("h4",{className:"text-lg font-semibold",children:["Questions (",s.questions.length,")"]}),(0,Vt.jsx)("button",{type:"button",onClick:()=>{const e={id:Date.now().toString(),question_text:"",options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}],image_url:null};l(u(u({},s),{},{questions:[...s.questions,e]})),h(s.questions.length)},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition duration-200",children:"\u2795 Add Question"})]}),(0,Vt.jsx)("div",{className:"space-y-4",children:s.questions.map(((e,t)=>(0,Vt.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,Vt.jsxs)("h5",{className:"font-semibold",children:["Question ",t+1]}),(0,Vt.jsxs)("div",{className:"flex gap-2",children:[(0,Vt.jsx)("button",{type:"button",onClick:()=>h(f===t?null:t),className:"text-blue-600 hover:text-blue-800",children:f===t?"\ud83d\udcdd Editing":"\u270f\ufe0f Edit"}),(0,Vt.jsx)("button",{type:"button",onClick:()=>(e=>{console.log("Attempting to remove question at index:",e),console.log("Current questions:",s.questions),w({show:!0,questionIndex:e})})(t),className:"text-red-600 hover:text-red-800",children:"\ud83d\uddd1\ufe0f Remove"})]})]}),f===t?(0,Vt.jsxs)("div",{className:"space-y-4",children:[(0,Vt.jsx)("input",{type:"text",value:e.question_text,onChange:e=>((e,t,n)=>{const r=[...s.questions];r[e][t]=n,l(u(u({},s),{},{questions:r}))})(t,"question_text",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg",placeholder:"Enter question text"}),(0,Vt.jsx)("div",{children:e.image_url?(0,Vt.jsxs)("div",{className:"relative inline-block",children:[(0,Vt.jsx)("img",{src:e.image_url,alt:"Question",className:"max-w-xs h-auto rounded-lg shadow"}),(0,Vt.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...s.questions];t[e].image_url=null,l(u(u({},s),{},{questions:t}))})(t),className:"absolute top-2 right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm hover:bg-red-700",children:"\u2715"})]}):(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("input",{type:"file",accept:"image/*",onChange:e=>b(e,t),className:"hidden",id:"imageUpload-".concat(t),disabled:m}),(0,Vt.jsx)("label",{htmlFor:"imageUpload-".concat(t),className:"cursor-pointer inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200 text-sm",children:m?"Uploading...":"\ud83d\udcf7 Add Image"})]})}),(0,Vt.jsx)("div",{className:"space-y-2",children:e.options.map(((e,n)=>(0,Vt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Vt.jsx)("input",{type:"radio",name:"correct-".concat(t),checked:e.is_correct,onChange:()=>y(t,n,"is_correct",!0)}),(0,Vt.jsx)("input",{type:"text",value:e.text,onChange:e=>y(t,n,"text",e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg",placeholder:"Option ".concat(String.fromCharCode(65+n))})]},n)))})]}):(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"mb-3",children:e.question_text}),e.image_url&&(0,Vt.jsx)("img",{src:e.image_url,alt:"Question",className:"max-w-xs h-auto rounded-lg shadow mb-3"}),(0,Vt.jsx)("div",{className:"grid grid-cols-2 gap-2",children:e.options.map(((e,t)=>(0,Vt.jsxs)("div",{className:"p-2 rounded text-sm ".concat(e.is_correct?"bg-green-100 text-green-800":"bg-gray-100"),children:[String.fromCharCode(65+t),". ",e.text,e.is_correct&&" \u2713"]},t)))})]})]},t)))})]}),(0,Vt.jsxs)("div",{className:"flex gap-4 pt-6 border-t",children:[(0,Vt.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition duration-200 font-semibold",children:"\ud83d\udcbe Update Quiz"}),(0,Vt.jsx)("button",{type:"button",onClick:n,className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]}),v.show&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"text-center mb-6",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\uddd1\ufe0f"}),(0,Vt.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Remove Question?"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm",children:["Are you sure you want to remove Question ",v.questionIndex+1,"?"]}),(0,Vt.jsx)("p",{className:"text-red-600 text-sm mt-2",children:"\u26a0\ufe0f This action cannot be undone."})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsx)("button",{onClick:()=>{const{questionIndex:e}=v;try{const t=s.questions.filter(((t,n)=>n!==e));console.log("Updated questions after removal:",t),l(u(u({},s),{},{questions:t})),h(null),w({show:!1,questionIndex:null}),console.log("Question removed successfully"),alert("Question removed successfully!")}catch(t){console.error("Error removing question:",t),alert("Error removing question: "+t.message),w({show:!1,questionIndex:null})}},className:"flex-1 bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 transition duration-200 font-semibold",children:"Yes, Remove"}),(0,Vt.jsx)("button",{onClick:()=>w({show:!1,questionIndex:null}),className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]})})]})})}function on(e){let{categories:t,fetchCategories:n}=e;const[r,s]=(0,a.useState)("global-subjects"),[l,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!1),[d,f]=(0,a.useState)({name:"",description:"",subfolders:[""]}),[h,m]=(0,a.useState)({show:!1,subjectId:null,subjectName:""});(0,a.useEffect)((()=>{"global-subjects"===r&&p()}),[r]);const p=async()=>{try{const e=await Jt("/admin/global-subjects");i(e.data)}catch(e){console.error("Error fetching global subjects:",e)}};return(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Subject & Category Management"}),"global-subjects"===r&&(0,Vt.jsx)("button",{onClick:()=>c(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition duration-200",children:"\u2795 Create Global Subject"})]}),(0,Vt.jsxs)("div",{className:"flex space-x-1 mb-6 border-b",children:[(0,Vt.jsx)("button",{onClick:()=>s("global-subjects"),className:"px-4 py-2 font-semibold transition duration-200 border-b-2 ".concat("global-subjects"===r?"text-indigo-600 border-indigo-600":"text-gray-500 border-transparent hover:text-gray-700"),children:"\ud83c\udf10 Global Subjects & Subfolders"}),(0,Vt.jsx)("button",{onClick:()=>s("quiz-categories"),className:"px-4 py-2 font-semibold transition duration-200 border-b-2 ".concat("quiz-categories"===r?"text-indigo-600 border-indigo-600":"text-gray-500 border-transparent hover:text-gray-700"),children:"\ud83d\udcc2 Legacy Quiz Categories"})]}),"global-subjects"===r&&(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border-l-4 border-blue-400 rounded",children:(0,Vt.jsxs)("p",{className:"text-blue-800 text-sm",children:[(0,Vt.jsx)("strong",{children:"Global Subjects & Subfolders:"})," These will be available to all users (admin and regular users) when creating quizzes. They serve as the standardized category system for the entire platform."]})}),0===l.length?(0,Vt.jsxs)("div",{className:"text-center py-12",children:[(0,Vt.jsx)("p",{className:"text-gray-500 text-lg mb-4",children:"No global subjects created yet."}),(0,Vt.jsx)("button",{onClick:()=>c(!0),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition duration-200",children:"Create Your First Global Subject"})]}):(0,Vt.jsx)("div",{className:"space-y-6",children:l.map((e=>{var t,n;return(0,Vt.jsxs)("div",{className:"border rounded-lg p-6 bg-gradient-to-r from-blue-50 to-indigo-50",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 flex items-center",children:["\ud83c\udf10 ",e.name]}),e.description&&(0,Vt.jsx)("p",{className:"text-gray-600 mt-1",children:e.description}),(0,Vt.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Created: ",new Date(e.created_at).toLocaleDateString()]})]}),(0,Vt.jsx)("button",{onClick:()=>{return t=e.id,n=e.name,void m({show:!0,subjectId:t,subjectName:n});var t,n},className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition duration-200",children:"\ud83d\uddd1\ufe0f Delete"})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("h4",{className:"font-semibold text-gray-700 mb-2",children:["\ud83d\udcc1 Subfolders (",(null===(t=e.subfolders)||void 0===t?void 0:t.length)||0,"):"]}),(0,Vt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:(null===(n=e.subfolders)||void 0===n?void 0:n.map((e=>(0,Vt.jsx)("div",{className:"bg-white border rounded-lg p-3 text-center shadow-sm",children:(0,Vt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.name})},e.id))))||(0,Vt.jsx)("p",{className:"text-gray-500 text-sm",children:"No subfolders"})})]})]},e.id)}))})]}),"quiz-categories"===r&&(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("div",{className:"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:(0,Vt.jsxs)("p",{className:"text-yellow-800 text-sm",children:[(0,Vt.jsx)("strong",{children:"Legacy Categories:"})," These are the old category system. Consider migrating to the new Global Subjects system for better organization."]})}),0===t.length?(0,Vt.jsx)("div",{className:"text-center py-12",children:(0,Vt.jsx)("p",{className:"text-gray-500 text-lg",children:"No legacy categories found."})}):(0,Vt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e=>(0,Vt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,Vt.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),e.description&&(0,Vt.jsx)("p",{className:"text-gray-600 text-sm mt-2",children:e.description}),(0,Vt.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Created: ",new Date(e.created_at).toLocaleDateString()]})]},e.id)))})]}),o&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-screen overflow-y-auto",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vt.jsx)("h3",{className:"text-xl font-semibold",children:"Create Global Subject"}),(0,Vt.jsx)("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,Vt.jsxs)("div",{className:"space-y-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Subject Name *"}),(0,Vt.jsx)("input",{type:"text",value:d.name,onChange:e=>f(u(u({},d),{},{name:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",placeholder:"e.g., Advanced Mathematics",required:!0})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Description"}),(0,Vt.jsx)("textarea",{value:d.description,onChange:e=>f(u(u({},d),{},{description:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",rows:"3",placeholder:"Brief description of this subject area"})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Subfolders"}),(0,Vt.jsxs)("div",{className:"space-y-2",children:[d.subfolders.map(((e,t)=>(0,Vt.jsxs)("div",{className:"flex gap-2",children:[(0,Vt.jsx)("input",{type:"text",value:e,onChange:e=>((e,t)=>{const n=[...d.subfolders];n[e]=t,f(u(u({},d),{},{subfolders:n}))})(t,e.target.value),className:"flex-1 p-2 border border-gray-300 rounded",placeholder:"Subfolder ".concat(t+1)}),d.subfolders.length>1&&(0,Vt.jsx)("button",{onClick:()=>(e=>{if(d.subfolders.length>1){const t=d.subfolders.filter(((t,n)=>n!==e));f(u(u({},d),{},{subfolders:t}))}})(t),className:"bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600",children:"\u2715"})]},t))),(0,Vt.jsx)("button",{onClick:()=>{f(u(u({},d),{},{subfolders:[...d.subfolders,""]}))},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 text-sm",children:"+ Add Subfolder"})]})]})]}),(0,Vt.jsxs)("div",{className:"flex gap-4 pt-6",children:[(0,Vt.jsx)("button",{onClick:async()=>{if(!d.name.trim())return void alert("Subject name is required");const e={name:d.name.trim(),description:d.description.trim(),subfolders:d.subfolders.filter((e=>e.trim())).map((e=>e.trim()))};try{await Jt("/admin/global-subject",{method:"POST",data:e}),c(!1),f({name:"",description:"",subfolders:[""]}),p(),alert("Global subject created successfully!")}catch(r){var t,n;alert("Error creating global subject: "+((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||r.message))}},className:"flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition duration-200 font-semibold",children:"\ud83c\udf10 Create Global Subject"}),(0,Vt.jsx)("button",{onClick:()=>c(!1),className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]})}),h.show&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"text-center mb-6",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\uddd1\ufe0f"}),(0,Vt.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Delete Global Subject?"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm",children:['Are you sure you want to delete "',h.subjectName,'"?']}),(0,Vt.jsx)("p",{className:"text-red-600 text-sm mt-2",children:"\u26a0\ufe0f This action cannot be undone and will affect all users."})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsx)("button",{onClick:async()=>{try{await Jt("/admin/global-subject/".concat(h.subjectId),{method:"DELETE"}),m({show:!1,subjectId:null,subjectName:""}),p(),alert("Global subject deleted successfully!")}catch(n){var e,t;alert("Error deleting global subject: "+((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||n.message))}},className:"flex-1 bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 transition duration-200 font-semibold",children:"Yes, Delete"}),(0,Vt.jsx)("button",{onClick:()=>m({show:!1,subjectId:null,subjectName:""}),className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]})})]})}function cn(e){let{setCurrentView:t}=e;const[n,r]=(0,a.useState)({title:"",description:"",category:"",subject:"",subcategory:"General",is_public:!1,allowed_users:[],questions:[],min_pass_percentage:60,time_limit_minutes:null,shuffle_questions:!1,shuffle_options:!1}),[s,l]=(0,a.useState)({question_text:"",question_type:"multiple_choice",points:1,difficulty:"medium",is_mandatory:!0,explanation:"",multiple_correct:!1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1}],open_ended_answer:{expected_answers:[""],keywords:[],case_sensitive:!1,partial_credit:!0},image_url:null,pdf_url:null}),[i,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)([]),[f,h]=(0,a.useState)({}),[m,p]=(0,a.useState)([]),[g,x]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!1),[v,w]=(0,a.useState)(null),[j,N]=(0,a.useState)(!1);(0,a.useEffect)((()=>{k(),n.is_public&&S()}),[n.is_public]),(0,a.useEffect)((()=>{const e=Object.keys(f);e.length>0&&!e.includes(n.subject)&&r((t=>u(u({},t),{},{subject:e[0],subcategory:"General"})))}),[f]);const k=async()=>{try{const e=await Jt("/admin/predefined-subjects");h(e.data)}catch(e){console.error("Error fetching subjects:",e),h({})}},S=async()=>{try{const e=await Jt("/admin/users");d(e.data.filter((e=>"user"===e.role)))}catch(e){console.error("Error fetching users:",e)}},_=(e,t)=>{l(u(u({},s),{},{open_ended_answer:u(u({},s.open_ended_answer),{},{[e]:t})}))},C=()=>{const e=[];return(!s.question_text||s.question_text.length<5)&&e.push("Question text must be at least 5 characters long"),s.points<=0&&e.push("Points must be positive"),"multiple_choice"===s.question_type?(s.options.length<2&&e.push("Multiple choice questions must have at least 2 options"),s.options.every((e=>e.text.trim()))||e.push("All options must have text"),s.options.some((e=>e.is_correct))||e.push("At least one option must be correct")):"open_ended"===s.question_type&&(s.open_ended_answer.expected_answers.some((e=>e.trim()))||e.push("At least one expected answer is required")),e},[E,z]=(0,a.useState)({show:!1,questionIndex:null}),P=e=>{console.log("Attempting to remove question at index:",e),z({show:!0,questionIndex:e})};return(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Vt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Create Advanced Quiz"}),0===Object.keys(f).length&&(0,Vt.jsxs)("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,Vt.jsx)("h4",{className:"text-yellow-800 font-semibold mb-2",children:"\ud83d\udcdd Create Subjects First"}),(0,Vt.jsx)("p",{className:"text-yellow-700 text-sm mb-3",children:"No subjects are available for quiz creation. You need to create subjects and subfolders first."}),(0,Vt.jsx)("button",{onClick:()=>t("categories"),className:"bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition duration-200 text-sm",children:"\ud83d\udcda Go to Categories & Subjects"})]}),m.length>0&&(0,Vt.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,Vt.jsx)("h4",{className:"text-red-800 font-semibold mb-2",children:"\u26a0\ufe0f Validation Errors:"}),(0,Vt.jsx)("ul",{className:"list-disc list-inside text-red-700 text-sm",children:m.map(((e,t)=>(0,Vt.jsx)("li",{children:e},t)))})]}),(0,Vt.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Quiz Title *"}),(0,Vt.jsx)("input",{type:"text",value:n.title,onChange:e=>r(u(u({},n),{},{title:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",placeholder:"Enter quiz title (min 3 characters)"})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Description *"}),(0,Vt.jsx)("textarea",{value:n.description,onChange:e=>r(u(u({},n),{},{description:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",rows:"3",placeholder:"Describe your quiz (min 10 characters)"})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Subject *"}),Object.keys(f).length>0?(0,Vt.jsx)("select",{value:n.subject,onChange:e=>r(u(u({},n),{},{subject:e.target.value,subcategory:"General"})),className:"w-full p-3 border border-gray-300 rounded-lg",children:Object.keys(f).map((e=>(0,Vt.jsx)("option",{value:e,children:e},e)))}):(0,Vt.jsx)("div",{className:"w-full p-3 border border-orange-300 bg-orange-50 rounded-lg",children:(0,Vt.jsx)("p",{className:"text-orange-700 text-sm",children:"\u26a0\ufe0f No subjects available. Please create subjects first in the Categories section."})})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Subcategory"}),Object.keys(f).length>0?(0,Vt.jsx)("select",{value:n.subcategory,onChange:e=>r(u(u({},n),{},{subcategory:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",children:(f[n.subject]||["General"]).map((e=>(0,Vt.jsx)("option",{value:e,children:e},e)))}):(0,Vt.jsx)("div",{className:"w-full p-3 border border-gray-300 bg-gray-50 rounded-lg",children:(0,Vt.jsx)("p",{className:"text-gray-500 text-sm",children:"No subcategories available"})})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Category *"}),(0,Vt.jsx)("input",{type:"text",value:n.category,onChange:e=>r(u(u({},n),{},{category:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",placeholder:"Specific topic"})]})]}),(0,Vt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Vt.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"Quiz Settings"}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Pass Percentage (%)"}),(0,Vt.jsx)("input",{type:"number",min:"0",max:"100",value:n.min_pass_percentage,onChange:e=>r(u(u({},n),{},{min_pass_percentage:parseFloat(e.target.value)||0})),className:"w-full p-3 border border-gray-300 rounded-lg"})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Time Limit (minutes)"}),(0,Vt.jsx)("input",{type:"number",min:"1",value:n.time_limit_minutes||"",onChange:e=>r(u(u({},n),{},{time_limit_minutes:e.target.value?parseInt(e.target.value):null})),className:"w-full p-3 border border-gray-300 rounded-lg",placeholder:"Optional"})]})]}),(0,Vt.jsxs)("div",{className:"flex flex-wrap gap-4 mt-4",children:[(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:n.shuffle_questions,onChange:e=>r(u(u({},n),{},{shuffle_questions:e.target.checked})),className:"mr-2"}),"Shuffle Questions"]}),(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:n.shuffle_options,onChange:e=>r(u(u({},n),{},{shuffle_options:e.target.checked})),className:"mr-2"}),"Shuffle Options"]}),(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:n.is_public,onChange:e=>r(u(u({},n),{},{is_public:e.target.checked,allowed_users:[]})),className:"mr-2"}),"Public Quiz"]})]}),n.is_public&&(0,Vt.jsxs)("div",{className:"mt-4",children:[(0,Vt.jsxs)("label",{className:"block text-gray-700 font-semibold mb-2",children:["Select Users (",n.allowed_users.length," selected)"]}),(0,Vt.jsx)("div",{className:"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-3",children:c.map((e=>(0,Vt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:n.allowed_users.includes(e.id),onChange:()=>{return t=e.id,void r(u(u({},n),{},{allowed_users:n.allowed_users.includes(t)?n.allowed_users.filter((e=>e!==t)):[...n.allowed_users,t]}));var t},className:"mr-3"}),(0,Vt.jsxs)("span",{className:"text-sm",children:[e.name," (",e.email,")"]})]},e.id)))})]})]})]}),(0,Vt.jsx)(dn,{currentQuestion:s,setCurrentQuestion:l,uploadingFile:i,handleFileUpload:async(e,t)=>{const n=e.target.files[0];if(!n)return;if(!("image"===t?["image/jpeg","image/jpg","image/png","image/gif","image/webp"]:["application/pdf"]).includes(n.type))return void alert("Please select a valid ".concat(t," file"));const r="image"===t?5242880:10485760;if(n.size>r)return void alert("File size must be less than ".concat("image"===t?"5MB":"10MB"));const a=await(async e=>{const t=new FormData;t.append("file",e);try{return o(!0),(await Jt("/admin/upload-file",{method:"POST",data:t,headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).data}catch(a){var n,r;return alert("Error uploading file: "+((null===(n=a.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.detail)||"Unknown error")),null}finally{o(!1)}})(n);if(a){const e="image"===t?"image_url":"pdf_url";l(u(u({},s),{},{[e]:a.url}))}},removeFile:e=>{const t="image"===e?"image_url":"pdf_url";l(u(u({},s),{},{[t]:null}))},addOption:()=>{s.options.length<6&&l(u(u({},s),{},{options:[...s.options,{text:"",is_correct:!1}]}))},removeOption:e=>{if(s.options.length>2){const t=s.options.filter(((t,n)=>n!==e));l(u(u({},s),{},{options:t}))}},updateOption:(e,t,n)=>{const r=[...s.options];"is_correct"===t&&n&&!s.multiple_correct&&r.forEach((e=>e.is_correct=!1)),r[e][t]=n,l(u(u({},s),{},{options:r}))},updateOpenEndedAnswer:_,addExpectedAnswer:()=>{const e=[...s.open_ended_answer.expected_answers,""];_("expected_answers",e)},updateExpectedAnswer:(e,t)=>{const n=[...s.open_ended_answer.expected_answers];n[e]=t,_("expected_answers",n)},removeExpectedAnswer:e=>{if(s.open_ended_answer.expected_answers.length>1){const t=s.open_ended_answer.expected_answers.filter(((t,n)=>n!==e));_("expected_answers",t)}},validateCurrentQuestion:C,addQuestion:()=>{const e=C();e.length>0?alert("Please fix the following errors:\\n"+e.join("\\n")):(r(u(u({},n),{},{questions:[...n.questions,u(u({},s),{},{id:Date.now().toString()})]})),l({question_text:"",question_type:"multiple_choice",points:1,difficulty:"medium",is_mandatory:!0,explanation:"",multiple_correct:!1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1}],open_ended_answer:{expected_answers:[""],keywords:[],case_sensitive:!1,partial_credit:!0},image_url:null,pdf_url:null}))}}),n.questions.length>0&&(0,Vt.jsxs)("div",{className:"mb-6",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Vt.jsxs)("h3",{className:"text-lg font-semibold",children:["Questions Added (",n.questions.length,") - Total Points: ",n.questions.reduce(((e,t)=>e+t.points),0)]}),(0,Vt.jsx)("button",{onClick:()=>x(!g),className:"text-blue-600 hover:text-blue-800 font-semibold",children:g?"\ud83d\udc41\ufe0f Hide Preview":"\ud83d\udc40 Show Preview"})]}),g&&(0,Vt.jsx)("div",{className:"space-y-4",children:n.questions.map(((e,t)=>(0,Vt.jsx)(mn,{question:e,index:t,onDelete:P},t)))})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsx)("button",{onClick:async()=>{const e=(()=>{const e=[];return 0===Object.keys(f).length&&e.push("No subjects available. Please create subjects first in the Categories section."),(!n.title||n.title.length<3)&&e.push("Title must be at least 3 characters long"),(!n.description||n.description.length<10)&&e.push("Description must be at least 10 characters long"),(!n.category||n.category.length<2)&&e.push("Category is required"),n.subject||e.push("Subject is required"),0===n.questions.length&&e.push("At least one question is required"),n.is_public&&0===n.allowed_users.length&&e.push("Please select at least one user for public quiz access"),e})();if(p(e),e.length>0)alert("Please fix validation errors before creating quiz");else try{const e=(await Jt("/admin/quiz",{method:"POST",data:n})).data;w(e),y(!0)}catch(s){var t;if(400===(null===(t=s.response)||void 0===t?void 0:t.status)){const e=s.response.data;e.detail&&e.detail.errors?(p(e.detail.errors),alert("Quiz validation failed. Please check the errors.")):alert("Error creating quiz: "+(e.detail||"Unknown error"))}else{var r,a;alert("Error creating quiz: "+((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.detail)||"Unknown error"))}}},className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition duration-200 font-semibold",children:"\ud83d\ude80 Create Advanced Quiz"}),(0,Vt.jsx)("button",{onClick:()=>t("quizzes"),className:"bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]}),E.show&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"text-center mb-6",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\uddd1\ufe0f"}),(0,Vt.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Remove Question?"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm",children:["Are you sure you want to remove Question ",E.questionIndex+1,"?"]}),(0,Vt.jsx)("p",{className:"text-red-600 text-sm mt-2",children:"\u26a0\ufe0f This action cannot be undone."})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsx)("button",{onClick:()=>{const{questionIndex:e}=E;try{const t=n.questions.filter(((t,n)=>n!==e));console.log("Updated questions after removal:",t),r(u(u({},n),{},{questions:t})),z({show:!1,questionIndex:null}),console.log("Question removed successfully from quiz creation"),alert("Question removed successfully!")}catch(t){console.error("Error removing question:",t),alert("Error removing question: "+t.message),z({show:!1,questionIndex:null})}},className:"flex-1 bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 transition duration-200 font-semibold",children:"Yes, Remove"}),(0,Vt.jsx)("button",{onClick:()=>z({show:!1,questionIndex:null}),className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]})}),b&&v&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4",children:[(0,Vt.jsxs)("div",{className:"text-center mb-6",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83c\udf89"}),(0,Vt.jsx)("h3",{className:"text-xl font-semibold mb-2 text-green-600",children:"Quiz Created Successfully!"}),(0,Vt.jsxs)("p",{className:"text-gray-800 font-medium mb-2",children:['"',v.title,'"']})]}),(0,Vt.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[(0,Vt.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Vt.jsx)("span",{className:"text-orange-600",children:"\u26a0\ufe0f"}),(0,Vt.jsx)("span",{className:"font-semibold text-orange-800",children:"IMPORTANT: Quiz Publishing"})]}),(0,Vt.jsxs)("p",{className:"text-sm text-orange-700 mb-2",children:["Your quiz is currently in ",(0,Vt.jsx)("strong",{children:"DRAFT MODE"}),". Users cannot take this quiz until it's published."]}),(0,Vt.jsxs)("div",{className:"bg-orange-100 p-2 rounded text-xs text-orange-800",children:["\ud83d\udcdd Draft Mode: Quiz is saved but not accessible to users",(0,Vt.jsx)("br",{}),"\ud83d\ude80 Published: Quiz is live and available for users to take"]})]}),(0,Vt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[(0,Vt.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Vt.jsx)("span",{className:"text-green-600",children:"\ud83d\ude80"}),(0,Vt.jsx)("span",{className:"font-semibold text-green-800",children:"Recommended Action"})]}),(0,Vt.jsxs)("p",{className:"text-sm text-green-700",children:[(0,Vt.jsx)("strong",{children:"Publish Now"})," to make your quiz available immediately. This is the most common choice."]})]}),(0,Vt.jsxs)("div",{className:"flex gap-3",children:[(0,Vt.jsx)("button",{onClick:async()=>{N(!0);try{await Jt("/admin/quiz/".concat(v.id,"/publish"),{method:"POST"}),y(!1),N(!1),alert("\ud83c\udf89 SUCCESS! Quiz published and ready for users!"),t("quizzes")}catch(r){var e,n;N(!1),alert("\u26a0\ufe0f Quiz created but failed to publish: "+((null===(e=r.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||"Unknown error")+"\n\nYou can publish it from the Quiz Management page."),t("quizzes")}},disabled:j,className:"flex-1 bg-green-600 text-white py-4 rounded-lg hover:bg-green-700 transition duration-200 font-semibold text-center disabled:opacity-50 disabled:cursor-not-allowed",children:j?(0,Vt.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,Vt.jsx)("span",{className:"animate-spin",children:"\u23f3"}),"Publishing..."]}):(0,Vt.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["\ud83d\ude80 Publish Quiz Now",(0,Vt.jsx)("span",{className:"text-xs bg-green-500 px-2 py-1 rounded",children:"RECOMMENDED"})]})}),(0,Vt.jsx)("button",{onClick:()=>{y(!1),alert("\ud83d\udcdd Quiz saved as DRAFT. Remember to publish it from the Quiz Management page when ready!"),t("quizzes")},disabled:j,className:"flex-1 bg-gray-600 text-white py-4 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:"\ud83d\udcdd Keep as Draft"})]}),(0,Vt.jsx)("div",{className:"text-center mt-4",children:(0,Vt.jsx)("p",{className:"text-xs text-gray-500",children:"\ud83d\udca1 You can always publish draft quizzes later from the Quiz Management page"})})]})})]})}function un(e){let{currentView:t,setCurrentView:n}=e;const{user:r,logout:s}=Yt(),[l,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(0),[f,h]=(0,a.useState)([]),[m,p]=(0,a.useState)(null),[g,x]=(0,a.useState)([]),[b,y]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null);(0,a.useEffect)((()=>{"home"===t&&k(),"my-attempts"===t&&S()}),[t]);const k=async()=>{try{const e=await Jt("/quizzes");i(e.data)}catch(e){console.error("Error fetching quizzes:",e)}},S=async()=>{try{const e=await Jt("/my-attempts");x(e.data)}catch(e){console.error("Error fetching attempts:",e)}},_=e=>{c(e),d(0),h([]),p(null),n("take-quiz")},C=e=>{const t=[...f];t[u]=e,h(t)},E=()=>{u<o.questions.length-1?d(u+1):z()},z=async()=>{console.log("\ud83c\udfaf Starting quiz submission..."),console.log("Quiz ID:",o.id),console.log("User answers:",f),w(!0),N(null);try{console.log("\ud83d\udce1 Making API call to:","/quiz/".concat(o.id,"/attempt"));const e=await Jt("/quiz/".concat(o.id,"/attempt"),{method:"POST",data:{quiz_id:o.id,answers:f}});if(console.log("\u2705 Quiz submission successful:",e.data),!e.data||"undefined"===typeof e.data.score)throw new Error("Invalid response data received from server");p(e.data),n("result")}catch(l){var e,t,r,a,s;console.error("\u274c Quiz submission failed:",l);let n="Unknown error occurred";"TypeError"===l.name&&l.message.includes("Failed to fetch")?n="Network error: Unable to reach the server. Please check your internet connection and try again.":404===(null===(e=l.response)||void 0===e?void 0:e.status)?n="Quiz not found or not published yet. Please contact the administrator.":403===(null===(t=l.response)||void 0===t?void 0:t.status)?n="You do not have permission to take this quiz.":401===(null===(r=l.response)||void 0===r?void 0:r.status)?n="Authentication failed. Please log in again.":null!==(a=l.response)&&void 0!==a&&null!==(s=a.data)&&void 0!==s&&s.detail?n=l.response.data.detail:l.message&&(n=l.message),N(n),console.log("\ud83d\udd04 Staying on quiz page due to submission error")}finally{w(!1)}};return"take-quiz"===t?(0,Vt.jsx)(gn,{quiz:o,currentQuestionIndex:u,setCurrentQuestionIndex:d,userAnswers:f,selectAnswer:C,nextQuestion:E,submitQuiz:z,setCurrentView:n,isSubmittingQuiz:v,quizError:j,setQuizError:N}):"result"===t?(0,Vt.jsx)(xn,{result:m,quiz:o,setCurrentView:n,startQuiz:_}):(0,Vt.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,Vt.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,Vt.jsxs)("div",{className:"container mx-auto px-4 py-4 flex flex-col lg:flex-row justify-between items-start lg:items-center",children:[(0,Vt.jsxs)("div",{className:"mb-4 lg:mb-0",children:[(0,Vt.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"\ud83d\udcdd Squiz"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm sm:text-base",children:["Welcome, ",r.name]})]}),(0,Vt.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-4",children:[(0,Vt.jsx)("button",{onClick:()=>n("home"),className:"px-3 sm:px-4 py-2 rounded-lg transition duration-200 text-xs sm:text-sm ".concat("home"===t?"bg-indigo-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"\ud83c\udfe0 Home"}),(0,Vt.jsx)("button",{onClick:()=>n("my-attempts"),className:"px-3 sm:px-4 py-2 rounded-lg transition duration-200 text-xs sm:text-sm ".concat("my-attempts"===t?"bg-indigo-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"\ud83d\udcca My Results"}),(0,Vt.jsx)("button",{onClick:()=>y(!0),className:"text-gray-700 hover:bg-gray-100 px-3 sm:px-4 py-2 rounded-lg transition duration-200 text-xs sm:text-sm",children:"\ud83d\udd11 Password"}),(0,Vt.jsx)("button",{onClick:s,className:"bg-red-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-red-700 transition duration-200 text-xs sm:text-sm",children:"Logout"})]})]})}),(0,Vt.jsxs)("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:["home"===t&&(0,Vt.jsx)(bn,{quizzes:l,startQuiz:_}),"my-attempts"===t&&(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:"My Quiz Results"}),0===g.length?(0,Vt.jsx)("div",{className:"text-center py-12",children:(0,Vt.jsx)("p",{className:"text-gray-500 text-lg",children:"You haven't taken any quizzes yet."})}):(0,Vt.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.map((e=>(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Vt.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"Quiz Attempt"}),(0,Vt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,Vt.jsxs)("div",{className:"flex justify-between",children:[(0,Vt.jsx)("span",{children:"Score:"}),(0,Vt.jsxs)("span",{className:"font-semibold",children:[e.score,"/",e.total_questions]})]}),(0,Vt.jsxs)("div",{className:"flex justify-between",children:[(0,Vt.jsx)("span",{children:"Percentage:"}),(0,Vt.jsxs)("span",{className:"font-semibold ".concat(e.percentage>=80?"text-green-600":e.percentage>=60?"text-yellow-600":"text-red-600"),children:[e.percentage.toFixed(1),"%"]})]}),(0,Vt.jsxs)("div",{className:"flex justify-between",children:[(0,Vt.jsx)("span",{children:"Date:"}),(0,Vt.jsx)("span",{children:new Date(e.attempted_at).toLocaleDateString()})]})]})]},e.id)))})]})]}),b&&(0,Vt.jsx)(pn,{onClose:()=>y(!1),userName:r.name})]})}function dn(e){let{currentQuestion:t,setCurrentQuestion:n,uploadingFile:r,handleFileUpload:s,removeFile:l,addOption:i,removeOption:o,updateOption:c,updateOpenEndedAnswer:d,addExpectedAnswer:f,updateExpectedAnswer:h,removeExpectedAnswer:m,validateCurrentQuestion:p,addQuestion:g}=e;const[x,b]=(0,a.useState)(!1),[y,v]=(0,a.useState)(null);return(0,a.useEffect)((()=>{const e=setTimeout((()=>{window.MathJax&&window.MathJax.typesetPromise().catch((e=>console.log("MathJax error:",e)))}),300);return()=>clearTimeout(e)}),[t.question_text,t.options]),(0,Vt.jsxs)("div",{className:"bg-gray-50 p-4 sm:p-6 rounded-lg mb-6",children:[(0,Vt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Question"}),(0,Vt.jsxs)("div",{className:"mb-4",children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Question Type"}),(0,Vt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"radio",name:"questionType",value:"multiple_choice",checked:"multiple_choice"===t.question_type,onChange:e=>n(u(u({},t),{},{question_type:e.target.value})),className:"mr-2"}),"\ud83d\udcdd Multiple Choice"]}),(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"radio",name:"questionType",value:"open_ended",checked:"open_ended"===t.question_type,onChange:e=>n(u(u({},t),{},{question_type:e.target.value})),className:"mr-2"}),"\u270f\ufe0f Open Ended"]})]})]}),(0,Vt.jsxs)("div",{className:"mb-4",children:[(0,Vt.jsxs)("label",{className:"block text-gray-700 font-semibold mb-2",children:["Question Text *",(0,Vt.jsx)("span",{className:"text-xs text-blue-600 ml-2",children:"(Math: Use $...$ for inline or $$...$$ for display math)"})]}),(0,Vt.jsx)("textarea",{value:t.question_text,onChange:e=>{n(u(u({},t),{},{question_text:e.target.value})),window.MathJax&&window.MathJax.typesetPromise().catch((e=>console.log("MathJax error:",e)))},className:"w-full p-3 border border-gray-300 rounded-lg text-sm sm:text-base",rows:"3",placeholder:"Enter your question (min 5 characters). Example: What is $\\\\sqrt{16}$?"}),t.question_text&&(0,Vt.jsxs)("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg",children:[(0,Vt.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"Preview:"}),(0,Vt.jsx)("div",{className:"tex2jax_process",children:Xt(t.question_text)})]})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Points"}),(0,Vt.jsx)("input",{type:"number",min:"1",max:"10",value:t.points,onChange:e=>n(u(u({},t),{},{points:parseInt(e.target.value)||1})),className:"w-full p-2 sm:p-3 border border-gray-300 rounded-lg text-sm"})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Difficulty"}),(0,Vt.jsxs)("select",{value:t.difficulty,onChange:e=>n(u(u({},t),{},{difficulty:e.target.value})),className:"w-full p-2 sm:p-3 border border-gray-300 rounded-lg text-sm",children:[(0,Vt.jsx)("option",{value:"easy",children:"\ud83d\udfe2 Easy"}),(0,Vt.jsx)("option",{value:"medium",children:"\ud83d\udfe1 Medium"}),(0,Vt.jsx)("option",{value:"hard",children:"\ud83d\udd34 Hard"})]})]}),(0,Vt.jsx)("div",{className:"flex items-center pt-4 sm:pt-8",children:(0,Vt.jsxs)("label",{className:"flex items-center text-sm",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:t.is_mandatory,onChange:e=>n(u(u({},t),{},{is_mandatory:e.target.checked})),className:"mr-2"}),"Mandatory"]})}),"multiple_choice"===t.question_type&&(0,Vt.jsx)("div",{className:"flex items-center pt-4 sm:pt-8",children:(0,Vt.jsxs)("label",{className:"flex items-center text-sm",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:t.multiple_correct,onChange:e=>n(u(u({},t),{},{multiple_correct:e.target.checked})),className:"mr-2"}),"Multiple Correct"]})})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Question Image"}),t.image_url?(0,Vt.jsxs)("div",{className:"relative",children:[(0,Vt.jsx)("img",{src:t.image_url,alt:"Question",className:"w-full h-32 object-cover rounded-lg"}),(0,Vt.jsx)("button",{onClick:()=>l("image"),className:"absolute top-1 right-1 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-700",children:"\u2715"})]}):(0,Vt.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[(0,Vt.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void alert("Please select an image file");if(t.size>5242880)return void alert("File size must be less than 5MB");const n=new FileReader;n.onload=e=>{v(e.target.result),b(!0)},n.readAsDataURL(t)},className:"hidden",id:"imageUpload",disabled:r}),(0,Vt.jsx)("label",{htmlFor:"imageUpload",className:"cursor-pointer inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition duration-200 text-sm ".concat(r?"opacity-50 cursor-not-allowed":""),children:r?"Uploading...":"\ud83d\udcf7 Upload & Crop Image"}),(0,Vt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF, WEBP (max 5MB)"})]})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Question PDF"}),t.pdf_url?(0,Vt.jsxs)("div",{className:"relative border rounded-lg p-4 bg-red-50",children:[(0,Vt.jsxs)("div",{className:"flex items-center",children:[(0,Vt.jsx)("span",{className:"text-2xl mr-2",children:"\ud83d\udcc4"}),(0,Vt.jsx)("span",{className:"text-sm font-medium",children:"PDF Attached"})]}),(0,Vt.jsx)("button",{onClick:()=>l("pdf"),className:"absolute top-1 right-1 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-700",children:"\u2715"})]}):(0,Vt.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[(0,Vt.jsx)("input",{type:"file",accept:"application/pdf",onChange:e=>s(e,"pdf"),className:"hidden",id:"pdfUpload",disabled:r}),(0,Vt.jsx)("label",{htmlFor:"pdfUpload",className:"cursor-pointer inline-flex items-center px-3 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition duration-200 text-sm ".concat(r?"opacity-50 cursor-not-allowed":""),children:r?"Uploading...":"\ud83d\udcc4 Upload PDF"}),(0,Vt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PDF files (max 10MB)"})]})]})]}),"multiple_choice"===t.question_type?(0,Vt.jsx)(fn,{currentQuestion:t,addOption:i,removeOption:o,updateOption:c}):(0,Vt.jsx)(hn,{currentQuestion:t,updateOpenEndedAnswer:d,addExpectedAnswer:f,updateExpectedAnswer:h,removeExpectedAnswer:m}),(0,Vt.jsxs)("div",{className:"mb-4",children:[(0,Vt.jsxs)("label",{className:"block text-gray-700 font-semibold mb-2",children:["Explanation (Optional)",(0,Vt.jsx)("span",{className:"text-xs text-blue-600 ml-2",children:"(Math supported)"})]}),(0,Vt.jsx)("textarea",{value:t.explanation,onChange:e=>n(u(u({},t),{},{explanation:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg text-sm",rows:"2",placeholder:"Explain the answer or provide additional context"})]}),(0,Vt.jsx)("button",{onClick:g,className:"w-full sm:w-auto bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:"\u2795 Add Question"}),x&&y&&(0,Vt.jsx)(Gt,{imageSrc:y,onCropComplete:e=>{n(u(u({},t),{},{image_url:e})),b(!1),v(null)},onClose:()=>{b(!1),v(null)}})]})}function fn(e){let{currentQuestion:t,addOption:n,removeOption:r,updateOption:a}=e;return(0,Vt.jsxs)("div",{className:"mb-4",children:[(0,Vt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-2",children:[(0,Vt.jsxs)("label",{className:"block text-gray-700 font-semibold mb-2 sm:mb-0",children:["Options *",(0,Vt.jsx)("span",{className:"text-xs text-blue-600 ml-2",children:"(Math supported)"})]}),(0,Vt.jsx)("div",{className:"flex gap-2",children:(0,Vt.jsx)("button",{type:"button",onClick:n,disabled:t.options.length>=6,className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 disabled:opacity-50",children:"\u2795 Add Option"})})]}),(0,Vt.jsx)("div",{className:"space-y-3",children:t.options.map(((e,n)=>(0,Vt.jsxs)("div",{className:"border rounded-lg p-3 bg-white",children:[(0,Vt.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Vt.jsx)("input",{type:t.multiple_correct?"checkbox":"radio",name:"correct-answer",checked:e.is_correct,onChange:e=>a(n,"is_correct",e.target.checked)}),(0,Vt.jsxs)("span",{className:"text-sm font-medium w-6",children:[String.fromCharCode(65+n),"."]}),(0,Vt.jsx)("input",{type:"text",value:e.text,onChange:e=>((e,t)=>{a(e,"text",t),setTimeout((()=>{window.MathJax&&window.MathJax.typesetPromise().catch((e=>console.log("MathJax error:",e)))}),300)})(n,e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg text-sm",placeholder:"Option ".concat(String.fromCharCode(65+n)," (e.g., $x^2$ or regular text)")}),t.options.length>2&&(0,Vt.jsx)("button",{type:"button",onClick:()=>r(n),className:"px-2 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:"\u2715"})]}),e.text&&(0,Vt.jsxs)("div",{className:"ml-8 text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[(0,Vt.jsx)("span",{className:"text-xs text-gray-500",children:"Preview: "}),(0,Vt.jsx)("span",{className:"tex2jax_process",children:Xt(e.text)})]})]},n)))}),(0,Vt.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[t.multiple_correct?"Check all correct answers":"Select one correct answer"," (2-6 options allowed)"]})]})}function hn(e){let{currentQuestion:t,updateOpenEndedAnswer:n,addExpectedAnswer:r,updateExpectedAnswer:a,removeExpectedAnswer:s}=e;return(0,Vt.jsxs)("div",{className:"space-y-4 mb-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold",children:"Expected Answers *"}),(0,Vt.jsx)("button",{type:"button",onClick:r,className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700",children:"\u2795 Add Answer"})]}),(0,Vt.jsx)("div",{className:"space-y-2",children:t.open_ended_answer.expected_answers.map(((e,n)=>(0,Vt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Vt.jsxs)("span",{className:"text-sm font-medium w-8",children:[n+1,"."]}),(0,Vt.jsx)("input",{type:"text",value:e,onChange:e=>a(n,e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg",placeholder:"Expected answer ".concat(n+1)}),t.open_ended_answer.expected_answers.length>1&&(0,Vt.jsx)("button",{type:"button",onClick:()=>s(n),className:"px-2 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:"\u2715"})]},n)))})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Keywords for Partial Credit"}),(0,Vt.jsx)("input",{type:"text",value:t.open_ended_answer.keywords.join(", "),onChange:e=>n("keywords",e.target.value.split(",").map((e=>e.trim())).filter((e=>e))),className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"Enter keywords separated by commas (optional)"}),(0,Vt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Keywords found in answers will give partial credit"})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:t.open_ended_answer.case_sensitive,onChange:e=>n("case_sensitive",e.target.checked),className:"mr-2"}),(0,Vt.jsx)("span",{className:"text-sm",children:"Case Sensitive"})]}),(0,Vt.jsxs)("label",{className:"flex items-center",children:[(0,Vt.jsx)("input",{type:"checkbox",checked:t.open_ended_answer.partial_credit,onChange:e=>n("partial_credit",e.target.checked),className:"mr-2"}),(0,Vt.jsx)("span",{className:"text-sm",children:"Allow Partial Credit"})]})]})]})}function mn(e){let{question:t,index:n,onDelete:r}=e;return(0,Vt.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,Vt.jsxs)("h4",{className:"font-semibold text-gray-800",children:["Question ",n+1,": ",Xt(t.question_text)]}),(0,Vt.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,Vt.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat((e=>{switch(e){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(t.difficulty)),children:t.difficulty}),(0,Vt.jsxs)("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:[t.points," pts"]}),!t.is_mandatory&&(0,Vt.jsx)("span",{className:"px-2 py-1 rounded text-xs bg-gray-100 text-gray-800",children:"Optional"}),r&&(0,Vt.jsx)("button",{onClick:()=>r(n),className:"px-2 py-1 rounded text-xs bg-red-600 text-white hover:bg-red-700 transition duration-200",title:"Remove Question",children:"\ud83d\uddd1\ufe0f Remove"})]})]}),(0,Vt.jsxs)("div",{className:"flex gap-4 mb-3",children:[t.image_url&&(0,Vt.jsx)("img",{src:t.image_url,alt:"Question",className:"w-32 h-20 object-cover rounded"}),t.pdf_url&&(0,Vt.jsx)("div",{className:"flex items-center p-2 bg-red-50 rounded",children:(0,Vt.jsx)("span",{className:"text-red-600",children:"\ud83d\udcc4 PDF Attached"})})]}),"multiple_choice"===t.question_type?(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:t.options.map(((e,t)=>(0,Vt.jsxs)("div",{className:"p-2 rounded text-sm ".concat(e.is_correct?"bg-green-100 text-green-800":"bg-gray-100"),children:[String.fromCharCode(65+t),". ",Xt(e.text),e.is_correct&&" \u2713"]},t)))}),t.multiple_correct&&(0,Vt.jsx)("p",{className:"text-xs text-blue-600",children:"Multiple correct answers allowed"})]}):(0,Vt.jsxs)("div",{className:"bg-yellow-50 p-3 rounded",children:[(0,Vt.jsx)("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Open-ended Question"}),(0,Vt.jsxs)("p",{className:"text-xs text-yellow-700",children:["Expected: ",t.open_ended_answer.expected_answers.join(" OR ")]}),t.open_ended_answer.keywords.length>0&&(0,Vt.jsxs)("p",{className:"text-xs text-yellow-700",children:["Keywords: ",t.open_ended_answer.keywords.join(", ")]})]}),t.explanation&&(0,Vt.jsx)("div",{className:"mt-3 p-2 bg-blue-50 rounded",children:(0,Vt.jsxs)("p",{className:"text-xs text-blue-700",children:[(0,Vt.jsx)("strong",{children:"Explanation:"})," ",t.explanation]})})]})}function pn(e){let{onClose:t,userName:n}=e;const[r,s]=(0,a.useState)({current_password:"",new_password:"",confirm_password:""}),[l,i]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1);return(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vt.jsx)("h3",{className:"text-lg font-semibold",children:"Change Password"}),(0,Vt.jsx)("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,Vt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i(""),r.new_password===r.confirm_password)if(r.new_password.length<6)i("New password must be at least 6 characters long");else try{c(!0),await Jt("/auth/change-password",{method:"POST",data:{current_password:r.current_password,new_password:r.new_password}}),alert("Password changed successfully!"),t()}catch(l){var n,a;i((null===(n=l.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.detail)||"Error changing password")}finally{c(!1)}else i("New passwords do not match")},className:"space-y-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Current Password"}),(0,Vt.jsx)("input",{type:"password",value:r.current_password,onChange:e=>s(u(u({},r),{},{current_password:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"New Password"}),(0,Vt.jsx)("input",{type:"password",value:r.new_password,onChange:e=>s(u(u({},r),{},{new_password:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0,minLength:"6"})]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Confirm New Password"}),(0,Vt.jsx)("input",{type:"password",value:r.confirm_password,onChange:e=>s(u(u({},r),{},{confirm_password:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0})]}),l&&(0,Vt.jsx)("div",{className:"p-3 rounded-lg bg-red-100 text-red-700",children:l}),(0,Vt.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,Vt.jsx)("button",{type:"submit",disabled:o,className:"flex-1 bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition duration-200 font-semibold disabled:opacity-50",children:o?"Changing...":"Change Password"}),(0,Vt.jsx)("button",{type:"button",onClick:t,className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Cancel"})]})]})]})})}function gn(e){var t;let{quiz:n,currentQuestionIndex:r,setCurrentQuestionIndex:s,userAnswers:l,selectAnswer:i,nextQuestion:o,submitQuiz:c,setCurrentView:u,isSubmittingQuiz:d,quizError:f,setQuizError:h}=e;const[m,p]=(0,a.useState)(!1);if(!n)return null;const g=n.questions[r],x=(r+1)/n.questions.length*100,b=e=>{const t=l[r]||"";if(g.multiple_correct){return t.split(", ").filter((e=>e&&""!==e.trim())).includes(e)}return t===e},y=()=>l.filter((e=>e&&""!==e.trim())).length;return(0,Vt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-teal-100",children:[(0,Vt.jsxs)("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[(0,Vt.jsxs)("header",{className:"mb-4 sm:mb-8",children:[(0,Vt.jsx)("button",{onClick:()=>u("home"),className:"mb-4 text-indigo-600 hover:text-indigo-800 font-semibold text-sm sm:text-base",children:"\u2190 Back to Home"}),(0,Vt.jsx)("h1",{className:"text-2xl sm:text-4xl font-bold text-teal-900 mb-2",children:Xt(n.title)}),(0,Vt.jsx)("p",{className:"text-gray-600 mb-4 text-sm sm:text-base",children:Xt(n.description)}),(0,Vt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3 mb-4",children:(0,Vt.jsx)("div",{className:"bg-teal-600 h-2 sm:h-3 rounded-full transition-all duration-300",style:{width:"".concat(x,"%")}})}),(0,Vt.jsxs)("div",{className:"flex justify-between items-center text-xs sm:text-sm text-gray-600",children:[(0,Vt.jsxs)("span",{children:["Question ",r+1," of ",n.questions.length]}),(0,Vt.jsxs)("span",{children:["Answered: ",y(),"/",n.questions.length]})]})]}),f&&(0,Vt.jsx)("div",{className:"max-w-4xl mx-auto mb-6",children:(0,Vt.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-r-lg",children:(0,Vt.jsxs)("div",{className:"flex items-start",children:[(0,Vt.jsx)("div",{className:"flex-shrink-0",children:(0,Vt.jsx)("span",{className:"text-red-400 text-xl",children:"\u274c"})}),(0,Vt.jsxs)("div",{className:"ml-3 flex-1",children:[(0,Vt.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Quiz Submission Failed"}),(0,Vt.jsx)("p",{className:"mt-1 text-sm text-red-700",children:f}),(0,Vt.jsx)("div",{className:"mt-3",children:(0,Vt.jsx)("button",{onClick:()=>h(null),className:"bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded text-sm transition duration-200",children:"Dismiss"})})]})]})})}),(0,Vt.jsxs)("div",{className:"max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-4 sm:p-8",children:[(0,Vt.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start mb-6",children:(0,Vt.jsxs)("div",{className:"flex-1",children:[(0,Vt.jsxs)("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[(0,Vt.jsx)("span",{className:"text-xl sm:text-2xl",children:(v=g.question_type,"multiple_choice"===v?"\ud83d\udcdd":"\u270f\ufe0f")}),(0,Vt.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat((e=>{switch(e){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(g.difficulty)),children:g.difficulty}),(0,Vt.jsxs)("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:[g.points," pts"]}),!g.is_mandatory&&(0,Vt.jsx)("span",{className:"px-2 py-1 rounded text-xs bg-gray-100 text-gray-800",children:"Optional"})]}),(0,Vt.jsx)("h2",{className:"text-lg sm:text-2xl font-semibold text-gray-800",children:Xt(g.question_text)})]})}),(0,Vt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[g.image_url&&(0,Vt.jsx)("div",{className:"mb-4 sm:mb-6",children:(0,Vt.jsx)("img",{src:g.image_url,alt:"Question",className:"max-w-full h-auto rounded-lg shadow",style:{maxHeight:"300px"}})}),g.pdf_url&&(0,Vt.jsx)("div",{className:"mb-4 sm:mb-6",children:(0,Vt.jsxs)("div",{className:"border-2 border-dashed border-red-300 rounded-lg p-4 sm:p-6 text-center bg-red-50",children:[(0,Vt.jsx)("div",{className:"text-2xl sm:text-4xl mb-2",children:"\ud83d\udcc4"}),(0,Vt.jsx)("p",{className:"text-red-700 font-medium text-sm sm:text-base",children:"PDF Attachment Available"}),(0,Vt.jsx)("a",{href:g.pdf_url,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-2 px-3 sm:px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition duration-200 text-sm",children:"View PDF"})]})})]}),(0,Vt.jsx)("div",{className:"mb-6 sm:mb-8",children:"multiple_choice"===g.question_type?(0,Vt.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[g.multiple_correct&&(0,Vt.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg mb-4",children:(0,Vt.jsx)("p",{className:"text-blue-800 text-sm font-medium",children:"\ud83d\udccc Multiple answers may be correct. Select all that apply."})}),g.options.map(((e,t)=>(0,Vt.jsx)("button",{onClick:()=>(e=>{if(console.log("Question multiple_correct flag:",g.multiple_correct),console.log("Current answers:",l[r]),console.log("Selecting option:",e),g.multiple_correct){const t=l[r]?l[r].split(", ").filter((e=>e&&""!==e.trim())):[];if(console.log("Current parsed answers:",t),t.includes(e)){const n=t.filter((t=>t!==e)).join(", ");console.log("Removing option, new answers:",n),i(n)}else{const n=[...t,e].join(", ");console.log("Adding option, new answers:",n),i(n)}}else console.log("Single selection mode, selecting:",e),i(e)})(e.text),className:"w-full p-3 sm:p-4 text-left rounded-lg border-2 transition duration-200 ".concat(b(e.text)?"border-teal-500 bg-teal-50 text-teal-800":"border-gray-200 hover:border-teal-300 hover:bg-teal-50"),children:(0,Vt.jsxs)("div",{className:"flex items-center",children:[(0,Vt.jsx)("div",{className:"w-4 h-4 mr-3 border-2 rounded ".concat(g.multiple_correct?"rounded-sm":"rounded-full"," ").concat(b(e.text)?"bg-teal-500 border-teal-500":"border-gray-300"),children:b(e.text)&&(0,Vt.jsx)("div",{className:"text-white text-xs text-center leading-4",children:g.multiple_correct?"\u2713":"\u25cf"})}),(0,Vt.jsxs)("span",{className:"font-semibold mr-3 text-sm sm:text-base",children:[String.fromCharCode(65+t),"."]}),(0,Vt.jsx)("span",{className:"flex-1 text-sm sm:text-base",children:Xt(e.text)})]})},t)))]}):(0,Vt.jsxs)("div",{className:"space-y-4",children:[(0,Vt.jsx)("div",{className:"p-3 bg-yellow-50 rounded-lg mb-4",children:(0,Vt.jsx)("p",{className:"text-yellow-800 text-sm font-medium",children:"\u270f\ufe0f Open-ended question. Type your answer in the text area below."})}),(0,Vt.jsx)("textarea",{value:l[r]||"",onChange:e=>{return t=e.target.value,void i(t);var t},className:"w-full p-3 sm:p-4 border-2 border-gray-300 rounded-lg focus:border-teal-500 focus:outline-none resize-y min-h-24 sm:min-h-32 text-sm sm:text-base",placeholder:"Type your answer here...",rows:"4"}),(0,Vt.jsxs)("div",{className:"text-xs sm:text-sm text-gray-500",children:[(null===(t=l[r])||void 0===t?void 0:t.length)||0," characters"]})]})}),(0,Vt.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-3 sm:gap-0",children:[(0,Vt.jsx)("button",{onClick:()=>s(Math.max(0,r-1)),disabled:0===r,className:"px-4 sm:px-6 py-2 sm:py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",children:"Previous"}),(0,Vt.jsxs)("div",{className:"flex gap-2 sm:gap-3",children:[(0,Vt.jsx)("button",{onClick:()=>{p(!0)},className:"px-3 sm:px-4 py-2 sm:py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition duration-200 font-semibold text-xs sm:text-sm",children:"\ud83c\udfc1 Finish Quiz"}),(0,Vt.jsx)("button",{onClick:o,disabled:!l[r]||l[r]&&""===l[r].trim(),className:"px-4 sm:px-6 py-2 sm:py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-sm sm:text-base",children:r===n.questions.length-1?"Submit Quiz":"Next Question"})]})]})]})]}),m&&(0,Vt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Vt.jsxs)("div",{className:"text-center mb-6",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83c\udfc1"}),(0,Vt.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Finish Quiz?"}),(0,Vt.jsxs)("p",{className:"text-gray-600 text-sm",children:["You have answered ",y()," out of ",n.questions.length," questions."]}),y()<n.questions.length&&(0,Vt.jsxs)("p",{className:"text-orange-600 text-sm mt-2",children:["\u26a0\ufe0f ",n.questions.length-y()," questions will be marked as unanswered."]})]}),(0,Vt.jsxs)("div",{className:"flex gap-4",children:[(0,Vt.jsx)("button",{onClick:()=>{p(!1),"function"===typeof c?c():console.error("submitQuiz function not available")},disabled:d,className:"flex-1 py-3 rounded-lg font-semibold transition duration-200 ".concat(d?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-orange-600 text-white hover:bg-orange-700"),children:d?(0,Vt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,Vt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Submitting..."]}):"Yes, Finish"}),(0,Vt.jsx)("button",{onClick:()=>p(!1),className:"flex-1 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition duration-200 font-semibold",children:"Continue Quiz"})]})]})})]});var v}function xn(e){let{result:t,quiz:n,setCurrentView:r,startQuiz:s}=e;const[l,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(!1);(0,a.useEffect)((()=>{t&&t.question_results&&i(t.question_results),f()}),[t,n]);const f=async()=>{try{const e=await Jt("/quiz/".concat(n.id,"/results-ranking"));c(e.data)}catch(e){console.error("Error fetching leaderboard:",e)}};if(!t)return null;const h=(m=t.percentage)>=80?{text:"Excellent!",color:"bg-green-500"}:m>=60?{text:"Good Job!",color:"bg-yellow-500"}:{text:"Keep Trying!",color:"bg-red-500"};var m;const p=l?l.filter((e=>!e.is_correct)):[];return(0,Vt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-orange-100",children:(0,Vt.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,Vt.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center mb-6",children:[(0,Vt.jsxs)("div",{className:"mb-8",children:[(0,Vt.jsx)("div",{className:"inline-block px-4 py-2 rounded-full text-white text-sm font-semibold mb-4 ".concat(h.color),children:h.text}),(0,Vt.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"Quiz Complete!"}),(0,Vt.jsx)("h2",{className:"text-2xl font-semibold text-gray-700 mb-6",children:n.title})]}),(0,Vt.jsxs)("div",{className:"mb-8",children:[(0,Vt.jsx)("div",{className:"text-6xl font-bold mb-4",children:(0,Vt.jsxs)("span",{className:(e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600")(t.percentage),children:[t.percentage.toFixed(1),"%"]})}),(0,Vt.jsxs)("p",{className:"text-xl text-gray-600 mb-2",children:["You scored ",t.score," out of ",t.total_questions," questions correctly"]}),(0,Vt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4 max-w-md mx-auto",children:(0,Vt.jsx)("div",{className:"h-4 rounded-full transition-all duration-1000 ".concat(t.percentage>=80?"bg-green-500":t.percentage>=60?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(t.percentage,"%")}})})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,Vt.jsx)("button",{onClick:()=>r("home"),className:"bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition duration-200 font-semibold",children:"\ud83c\udfe0 Back to Home"}),(0,Vt.jsx)("button",{onClick:()=>s(n),className:"bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition duration-200 font-semibold",children:"\ud83d\udd04 Retake Quiz"}),(0,Vt.jsx)("button",{onClick:()=>d(!u),className:"bg-orange-600 text-white py-3 rounded-lg hover:bg-orange-700 transition duration-200 font-semibold",children:u?"\ud83d\udc41\ufe0f Hide Review":"\ud83d\udcdd Review Mistakes"})]})]}),u&&l&&(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,Vt.jsx)("h3",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"\ud83d\udcdd Detailed Review"}),(0,Vt.jsx)("div",{className:"space-y-4",children:l.map(((e,t)=>(0,Vt.jsxs)("div",{className:"border rounded-lg p-4 ".concat(e.is_correct?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[(0,Vt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,Vt.jsxs)("h4",{className:"font-semibold text-gray-800",children:["Question ",e.question_number,": ",e.question_text]}),(0,Vt.jsx)("span",{className:"px-2 py-1 rounded text-sm font-semibold ".concat(e.is_correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_correct?"\u2705 Correct":"\u274c Wrong"})]}),e.question_image&&(0,Vt.jsx)("img",{src:e.question_image,alt:"Question",className:"max-w-xs h-auto rounded-lg shadow mb-3"}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Your Answer:"}),(0,Vt.jsx)("p",{className:"p-2 rounded ".concat(e.is_correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.user_answer})]}),!e.is_correct&&(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("p",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Correct Answer:"}),(0,Vt.jsx)("p",{className:"p-2 rounded bg-green-100 text-green-800",children:e.correct_answer})]})]}),!e.is_correct&&(0,Vt.jsxs)("div",{className:"mt-3",children:[(0,Vt.jsx)("p",{className:"text-sm font-semibold text-gray-600 mb-2",children:"All Options:"}),(0,Vt.jsx)("div",{className:"grid grid-cols-2 gap-2",children:e.all_options.map(((t,n)=>(0,Vt.jsxs)("div",{className:"p-2 rounded text-sm ".concat(t===e.correct_answer?"bg-green-100 text-green-800 border-2 border-green-300":t===e.user_answer?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-700"),children:[String.fromCharCode(65+n),". ",t,t===e.correct_answer&&" \u2713",t===e.user_answer&&t!==e.correct_answer&&" \u2717"]},n)))})]})]},t)))}),(0,Vt.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,Vt.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"Summary:"}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("span",{className:"text-green-600 font-semibold",children:"Correct: "}),l.filter((e=>e.is_correct)).length," questions"]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("span",{className:"text-red-600 font-semibold",children:"Incorrect: "}),p.length," questions"]}),(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("span",{className:"text-blue-600 font-semibold",children:"Accuracy: "}),t.percentage.toFixed(1),"%"]})]})]})]}),o&&(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,Vt.jsx)("h3",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"\ud83c\udfc6 Quiz Leaderboard"}),(0,Vt.jsxs)("div",{className:"mb-6",children:[(0,Vt.jsx)("h4",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Top 3 Performers"}),(0,Vt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:o.top_3.map(((e,t)=>(0,Vt.jsxs)("div",{className:"p-4 rounded-lg text-center ".concat(0===t?"bg-yellow-100 border-2 border-yellow-300":1===t?"bg-gray-100 border-2 border-gray-300":"bg-orange-100 border-2 border-orange-300"),children:[(0,Vt.jsx)("div",{className:"text-2xl mb-2",children:0===t?"\ud83e\udd47":1===t?"\ud83e\udd48":"\ud83e\udd49"}),(0,Vt.jsx)("p",{className:"font-semibold text-gray-800",children:e.user_name}),(0,Vt.jsxs)("p",{className:"text-lg font-bold text-gray-900",children:[e.percentage.toFixed(1),"%"]}),(0,Vt.jsxs)("p",{className:"text-sm text-gray-600",children:[e.score,"/",e.total_questions," correct"]})]},t)))})]}),o.user_position&&(0,Vt.jsxs)("div",{className:"mb-6 p-4 bg-indigo-50 rounded-lg",children:[(0,Vt.jsx)("h4",{className:"text-lg font-semibold text-indigo-800 mb-2",children:"Your Position"}),(0,Vt.jsxs)("p",{className:"text-indigo-700",children:["You ranked ",(0,Vt.jsxs)("span",{className:"font-bold",children:["#",o.user_position.rank]})," out of"," ",(0,Vt.jsx)("span",{className:"font-bold",children:o.total_participants})," participants!"]})]}),(0,Vt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[(0,Vt.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,Vt.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:o.total_participants}),(0,Vt.jsx)("p",{className:"text-sm text-gray-600",children:"Total Participants"})]}),(0,Vt.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,Vt.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:o.quiz_stats.total_attempts}),(0,Vt.jsx)("p",{className:"text-sm text-gray-600",children:"Total Attempts"})]}),(0,Vt.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,Vt.jsxs)("p",{className:"text-2xl font-bold text-gray-800",children:[o.quiz_stats.average_score.toFixed(1),"%"]}),(0,Vt.jsx)("p",{className:"text-sm text-gray-600",children:"Average Score"})]})]})]})]})})})}function bn(e){let{quizzes:t,startQuiz:n}=e;const[r,s]=(0,a.useState)(null),[l,i]=(0,a.useState)(null),o=t.reduce(((e,t)=>{const n=t.subject||"General",r=t.subcategory||"General";return e[n]||(e[n]={}),e[n][r]||(e[n][r]=[]),e[n][r].push(t),e}),{}),c=Object.keys(o).sort(),u=()=>{s(null),i(null)},d=()=>{i(null)},f=e=>{let{children:t,onClick:n,icon:r=""}=e;return(0,Vt.jsxs)("button",{onClick:n,className:"cssbuttons-io",style:{position:"relative",fontFamily:"inherit",fontWeight:500,fontSize:"18px",letterSpacing:"0.05em",borderRadius:"0.8em",cursor:"pointer",border:"none",background:"linear-gradient(to right, #8e2de2, #4a00e0)",color:"ghostwhite",overflow:"hidden",margin:"0.5rem",transition:"transform 0.2s"},onMouseEnter:e=>{e.target.style.transform="scale(1.02)"},onMouseLeave:e=>{e.target.style.transform="scale(1)"},onMouseDown:e=>{e.target.style.transform="scale(0.95)"},onMouseUp:e=>{e.target.style.transform="scale(1.02)"},children:[(0,Vt.jsxs)("span",{style:{position:"relative",zIndex:10,transition:"color 0.4s",display:"inline-flex",alignItems:"center",padding:"0.8em 1.2em 0.8em 1.05em"},children:[r&&(0,Vt.jsx)("span",{style:{marginRight:"0.5em"},children:r}),t]}),(0,Vt.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0,content:'""',background:"#000",width:"120%",left:"-10%",transform:"skew(30deg)",transition:"transform 0.4s cubic-bezier(0.3, 1, 0.8, 1)"}})]})};if(0===t.length)return(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Available Quizzes"}),(0,Vt.jsx)("div",{className:"text-center py-12",children:(0,Vt.jsx)("p",{className:"text-gray-500 text-lg",children:"No quizzes available yet."})})]});if(r&&l){const e=o[r][l];return(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("div",{className:"mb-6",children:[(0,Vt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,Vt.jsx)(f,{onClick:u,icon:"\ud83c\udfe0",children:"All Subjects"}),(0,Vt.jsx)("span",{className:"text-gray-500",children:"\u2192"}),(0,Vt.jsx)(f,{onClick:d,icon:"\ud83d\udcda",children:r}),(0,Vt.jsx)("span",{className:"text-gray-500",children:"\u2192"}),(0,Vt.jsxs)("span",{className:"text-lg font-semibold text-gray-800",children:["\ud83d\udcc2 ",l]})]}),(0,Vt.jsxs)("h2",{className:"text-3xl font-bold text-gray-800",children:[r," - ",l," Quizzes"]})]}),(0,Vt.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map((e=>(0,Vt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition duration-200",children:[(0,Vt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e.title}),(0,Vt.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-4 text-sm text-gray-500",children:[(0,Vt.jsxs)("span",{children:[e.total_questions," questions"]}),(0,Vt.jsxs)("span",{children:[e.total_attempts||0," attempts"]})]}),(0,Vt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Vt.jsxs)("span",{className:"text-sm text-gray-500",children:["Category: ",e.category]}),(0,Vt.jsxs)("span",{className:"text-sm text-gray-500",children:["Avg: ",e.average_score||0,"%"]})]}),(0,Vt.jsx)("button",{onClick:()=>n(e),className:"w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition duration-200 font-semibold",children:"\ud83c\udfaf Take Quiz"})]},e.id)))})]})}if(r){const e=Object.keys(o[r]).sort();return(0,Vt.jsxs)("div",{children:[(0,Vt.jsxs)("div",{className:"mb-6",children:[(0,Vt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,Vt.jsx)(f,{onClick:u,icon:"\ud83c\udfe0",children:"All Subjects"}),(0,Vt.jsx)("span",{className:"text-gray-500",children:"\u2192"}),(0,Vt.jsxs)("span",{className:"text-lg font-semibold text-gray-800",children:["\ud83d\udcda ",r]})]}),(0,Vt.jsxs)("h2",{className:"text-3xl font-bold text-gray-800",children:[r," Subcategories"]})]}),(0,Vt.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:e.map((e=>{const t=o[r][e].length;return(0,Vt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition duration-200",children:(0,Vt.jsxs)("div",{className:"text-center",children:[(0,Vt.jsx)("div",{className:"text-4xl mb-3",children:"\ud83d\udcc2"}),(0,Vt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e}),(0,Vt.jsxs)("p",{className:"text-gray-500 mb-4",children:[t," quiz",1!==t?"es":""]}),(0,Vt.jsx)(f,{onClick:()=>i(e),icon:"\ud83d\udcd6",children:"View Quizzes"})]})},e)}))})]})}return(0,Vt.jsxs)("div",{children:[(0,Vt.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:"\ud83d\udcda Quiz Subjects"}),(0,Vt.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:c.map((e=>{const t=Object.keys(o[e]).length,n=Object.values(o[e]).reduce(((e,t)=>e+t.length),0);return(0,Vt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition duration-200",children:(0,Vt.jsxs)("div",{className:"text-center",children:[(0,Vt.jsx)("div",{className:"text-5xl mb-4",children:(e=>{const t=e.toLowerCase();return t.includes("math")?"\ud83d\udd22":t.includes("science")?"\ud83d\udd2c":t.includes("physics")?"\u269b\ufe0f":t.includes("chemistry")?"\ud83e\uddea":t.includes("biology")?"\ud83e\uddec":t.includes("history")?"\ud83d\udcdc":t.includes("english")||t.includes("language")?"\ud83d\udcdd":t.includes("geography")?"\ud83c\udf0d":t.includes("computer")?"\ud83d\udcbb":"\ud83d\udcda"})(e)}),(0,Vt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e}),(0,Vt.jsxs)("p",{className:"text-gray-500 mb-2",children:[t," subcategor",1!==t?"ies":"y"]}),(0,Vt.jsxs)("p",{className:"text-gray-500 mb-4",children:[n," quiz",1!==n?"es":""]}),(0,Vt.jsxs)(f,{onClick:()=>s(e),icon:"\ud83d\uddc2\ufe0f",children:["Explore ",e]})]})},e)}))})]})}const yn=function(){return(0,Vt.jsx)(Kt,{children:(0,Vt.jsx)(Zt,{})})};s.createRoot(document.getElementById("root")).render((0,Vt.jsx)(a.StrictMode,{children:(0,Vt.jsx)(yn,{})}))})();